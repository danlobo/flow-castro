{"version":3,"file":"ContextMenu.js","sources":["../../../src/ContextMenu.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\n\nconst ContextMenuList = ({ isFiltered, options, onSelectOption, style }) => {\n  const [activeSubmenu, setActiveSubmenu] = useState(null)\n  const [activeSubmenuPosition, setActiveSubmenuPosition] = useState(null)\n  const [submenuDirection, setSubmenuDirection] = useState('left')\n  const [submenuDirectionVertical, setSubmenuDirectionVertical] = useState('top')\n\n  const handleMenuItemMouseEnter = (e, parentId) => {\n    setActiveSubmenu(parentId);\n    const pos = e.currentTarget.getBoundingClientRect().top - e.currentTarget.parentNode.getBoundingClientRect().top\n    setActiveSubmenuPosition(pos);\n\n    const viewportWidth = window.innerWidth;\n    const submenuWidth = e.target.getBoundingClientRect().width;\n\n    const viewportHeight = window.innerHeight;\n    const submenuHeight = e.target.getBoundingClientRect().height;\n\n    const rightEdge = e.currentTarget.getBoundingClientRect().right;\n    if (rightEdge + submenuWidth > viewportWidth) {\n      setSubmenuDirection(\"right\");\n    } else {\n      setSubmenuDirection(\"left\");\n    }\n\n    const bottomEdge = e.currentTarget.getBoundingClientRect().bottom;\n    if (bottomEdge + submenuHeight > viewportHeight) {\n      setSubmenuDirectionVertical(\"bottom\");\n    } else {\n      setSubmenuDirectionVertical(\"top\");\n    }\n  };\n\n  const handleMenuItemMouseLeave = () => {\n    setActiveSubmenu(null);\n  };\n\n  return (\n    <ul className=\"context-menu\" style={style}>\n      {options?.filter(isFiltered)?.map((option) => {\n        if (option.separator === true)\n          return <li key={option.id} ><hr /></li>\n\n        return <li\n          key={option.label}\n          onClick={() => onSelectOption(option)}\n          onMouseEnter={(e) => handleMenuItemMouseEnter(e, option.label)}\n          onMouseLeave={() => handleMenuItemMouseLeave()}\n        >\n          <div style={{ display: 'flex', alignItems: 'center' }}>\n            <div style={{ flex: '1 1 auto', display: 'flex', flexDirection: 'column' }}>\n              <div style={option.style}>{option.label}</div>\n              {option.description && <div style={{ color: 'gray', fontSize: '.8rem', fontStyle: 'italic' }}>{option.description}</div>}\n            </div>\n            {option.children && <div style={{ flex: '0 0 auto', fontSize: '.8rem', color: 'gray' }}>â–¶</div>}\n          </div>\n\n          {option.children && option.label === activeSubmenu && (\n              <ContextMenuList\n                isFiltered={isFiltered}\n                options={option.children.map((o) => ({ ...o, _parent: option }))}\n                onSelectOption={onSelectOption}\n                style={{\n                  position: 'absolute', \n                  [submenuDirection]: '100%', \n                  top: submenuDirectionVertical === 'top' ? activeSubmenuPosition : null, \n                  bottom: submenuDirectionVertical === 'bottom' ? 0 : null \n                }}/>\n            )}\n        </li>\n      })}\n    </ul>\n  )\n}\n\n\nexport const ContextMenu = ({ children }) => {\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [options, setOptions] = useState(null);\n  const [search, setSearch] = useState('')\n\n  const menuRef = useRef(null);\n  const searchRef = useRef(null);\n\n  const handleContextMenu = (e, options) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    setTimeout(() => searchRef.current?.focus(), 0)\n    \n    setOptions(options);\n    setPosition({ x: e.clientX, y: e.clientY });\n  };\n\n  const handleMenuItemClick = (option) => {\n    option.onClick?.(option)\n    setSearch('')\n    setOptions(null)\n  };\n\n  const handleOutsideClick = (e) => {\n    if (menuRef.current && !menuRef.current.contains(e.target)) {\n      setSearch('')\n      setOptions(null);\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener('mousedown', handleOutsideClick);\n    return () => {\n      document.removeEventListener('mousedown', handleOutsideClick);\n    };\n  }, []);\n\n  const isFiltered = (option) => {\n    if (!search?.length)\n      return true\n\n    const _search = search.toLocaleLowerCase()\n\n    if ((option.label?.toLowerCase()?.indexOf(_search) ?? -1) > -1)\n      return true\n\n    if ((option.description?.toLowerCase()?.indexOf(_search) ?? -1) > -1)\n      return true\n\n    return false\n  }\n\n  return (\n    <>\n      {children({ handleContextMenu })}\n      <div ref={menuRef} className=\"context-menu\" style={{ left: position.x, top: position.y, visibility: options ? 'visible' : 'hidden' }}>\n        <input ref={searchRef} type=\"text\" placeholder=\"Buscar...\" autoFocus value={search ?? ''} onChange={(e) => setSearch(e.target.value)} />\n        <ContextMenuList isFiltered={isFiltered} options={options} onSelectOption={handleMenuItemClick} style={{position: 'relative'}}/>\n      </div>\n    </>\n  )\n};"],"names":["ContextMenuList","_ref","_options$filter","isFiltered","options","onSelectOption","style","activeSubmenu","setActiveSubmenu","useState","activeSubmenuPosition","setActiveSubmenuPosition","submenuDirection","setSubmenuDirection","submenuDirectionVertical","setSubmenuDirectionVertical","handleMenuItemMouseEnter","e","parentId","pos","currentTarget","getBoundingClientRect","top","parentNode","viewportWidth","window","innerWidth","submenuWidth","target","width","viewportHeight","innerHeight","submenuHeight","height","rightEdge","right","bottomEdge","bottom","handleMenuItemMouseLeave","_jsx","className","children","filter","map","option","separator","id","_jsxs","onClick","onMouseEnter","label","onMouseLeave","display","alignItems","flex","flexDirection","description","color","fontSize","fontStyle","o","_objectSpread","_parent","position","ContextMenu","_ref2","setPosition","x","y","setOptions","search","setSearch","menuRef","useRef","searchRef","handleContextMenu","preventDefault","stopPropagation","setTimeout","_searchRef$current","current","focus","clientX","clientY","handleMenuItemClick","_option$onClick","call","handleOutsideClick","contains","useEffect","document","addEventListener","removeEventListener","_option$label$toLower","_option$label","_option$label$toLower2","_option$description$t","_option$description","_option$description$t2","length","_search","toLocaleLowerCase","toLowerCase","indexOf","_Fragment","ref","left","visibility","type","placeholder","autoFocus","value","onChange"],"mappings":"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"}