{"version":3,"file":"ContextMenu.js","sources":["../../../src/ContextMenu.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport css from './ContextMenu.module.css'\nimport { useTheme } from \"./ThemeProvider\";\n\nconst ContextMenuList = ({ isFiltered, options, onSelectOption, style }) => {\n  const [activeSubmenu, setActiveSubmenu] = useState(null)\n  const [activeSubmenuPosition, setActiveSubmenuPosition] = useState(null)\n  const [submenuDirection, setSubmenuDirection] = useState('left')\n  const [submenuDirectionVertical, setSubmenuDirectionVertical] = useState('top')\n\n  const handleMenuItemMouseEnter = (e, parentId) => {\n    setActiveSubmenu(parentId);\n    const pos = e.currentTarget.getBoundingClientRect().top - e.currentTarget.parentNode.getBoundingClientRect().top\n    setActiveSubmenuPosition(pos);\n\n    const viewportWidth = window.innerWidth;\n    const submenuWidth = e.target.getBoundingClientRect().width;\n\n    const viewportHeight = window.innerHeight;\n    const submenuHeight = e.target.getBoundingClientRect().height;\n\n    const rightEdge = e.currentTarget.getBoundingClientRect().right;\n    if (rightEdge + submenuWidth > viewportWidth) {\n      setSubmenuDirection(\"right\");\n    } else {\n      setSubmenuDirection(\"left\");\n    }\n\n    const bottomEdge = e.currentTarget.getBoundingClientRect().bottom;\n    if (bottomEdge + submenuHeight > viewportHeight) {\n      setSubmenuDirectionVertical(\"bottom\");\n    } else {\n      setSubmenuDirectionVertical(\"top\");\n    }\n  };\n\n  const handleMenuItemMouseLeave = () => {\n    setActiveSubmenu(null);\n  };\n\n  return (\n    <ul className={css.contextMenu} style={style}>\n      {options?.filter(isFiltered)?.map((option, index) => {\n        if (option.separator === true)\n          return <li key={`${option.id}-${index}`} ><hr /></li>\n\n        return <li\n          key={`${option.label}-${index}`}\n          onClick={() => onSelectOption(option)}\n          onMouseEnter={(e) => handleMenuItemMouseEnter(e, option.label)}\n          onMouseLeave={() => handleMenuItemMouseLeave()}\n        >\n          <div className={css.contextMenuItemContainer}>\n            <div className={css.contextMenuItemLabelContainer}>\n              <div className={css.contextMenuItemLabel} style={option.style}>{option.label}</div>\n              {option.description && <div className={css.contextMenuItemDescription}>{option.description}</div>}\n            </div>\n            {option.children && <div className={css.contextMenuItemSubMenu}>â–¶</div>}\n          </div>\n\n          {option.children && option.label === activeSubmenu && (\n              <ContextMenuList\n                isFiltered={isFiltered}\n                options={option.children.map((o) => ({ ...o, _parent: option }))}\n                onSelectOption={onSelectOption}\n                className={css.submenu}\n                style={{\n                  [submenuDirection]: '100%', \n                  top: submenuDirectionVertical === 'top' ? activeSubmenuPosition : null, \n                  bottom: submenuDirectionVertical === 'bottom' ? 0 : null \n                }}/>\n            )}\n        </li>\n      })}\n    </ul>\n  )\n}\n\n\nexport const ContextMenu = ({ children }) => {\n  const { currentTheme } = useTheme()\n\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [options, setOptions] = useState(null);\n  const [search, setSearch] = useState('')\n\n  const menuRef = useRef(null);\n  const searchRef = useRef(null);\n\n  const handleContextMenu = (e, options) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    setTimeout(() => searchRef.current?.focus(), 0)\n    \n    setOptions(options);\n    setPosition({ x: e.clientX, y: e.clientY });\n  };\n\n  const handleMenuItemClick = (option) => {\n    option.onClick?.(option)\n    setSearch('')\n    setOptions(null)\n  };\n\n  const handleOutsideClick = (e) => {\n    if (menuRef.current && !menuRef.current.contains(e.target)) {\n      setSearch('')\n      setOptions(null);\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener('mousedown', handleOutsideClick);\n    return () => {\n      document.removeEventListener('mousedown', handleOutsideClick);\n    };\n  }, []);\n\n  const isFiltered = (option) => {\n    if (!search?.length)\n      return true\n\n    const _search = search.toLocaleLowerCase()\n\n    if ((option.label?.toLowerCase()?.indexOf(_search) ?? -1) > -1)\n      return true\n\n    if ((option.description?.toLowerCase()?.indexOf(_search) ?? -1) > -1)\n      return true\n\n    return false\n  }\n\n  return (\n    <>\n      {children({ handleContextMenu })}\n      {options?.length ? <div ref={menuRef} className={css.container} style={{ left: position.x, top: position.y, visibility: options ? 'visible' : 'hidden' }}>\n        <input ref={searchRef} type=\"text\" placeholder=\"Buscar...\" autoFocus value={search ?? ''} onChange={(e) => setSearch(e.target.value)} />\n        <ContextMenuList isFiltered={isFiltered} options={options} onSelectOption={handleMenuItemClick} style={{position: 'relative'}}/>\n      </div> : null}\n    </>\n  )\n};"],"names":["ContextMenuList","_ref","_options$filter","isFiltered","options","onSelectOption","style","activeSubmenu","setActiveSubmenu","useState","activeSubmenuPosition","setActiveSubmenuPosition","submenuDirection","setSubmenuDirection","submenuDirectionVertical","setSubmenuDirectionVertical","handleMenuItemMouseEnter","e","parentId","pos","currentTarget","getBoundingClientRect","top","parentNode","viewportWidth","window","innerWidth","submenuWidth","target","width","viewportHeight","innerHeight","submenuHeight","height","rightEdge","right","bottomEdge","bottom","handleMenuItemMouseLeave","_jsx","className","css","contextMenu","children","filter","map","option","index","separator","concat","id","_jsxs","onClick","onMouseEnter","label","onMouseLeave","contextMenuItemContainer","contextMenuItemLabelContainer","contextMenuItemLabel","description","contextMenuItemDescription","contextMenuItemSubMenu","o","_objectSpread","_parent","submenu","ContextMenu","_ref2","useTheme","position","setPosition","x","y","setOptions","search","setSearch","menuRef","useRef","searchRef","handleContextMenu","preventDefault","stopPropagation","setTimeout","_searchRef$current","current","focus","clientX","clientY","handleMenuItemClick","_option$onClick","call","handleOutsideClick","contains","useEffect","document","addEventListener","removeEventListener","_option$label$toLower","_option$label","_option$description$t","_option$description","length","_search","toLocaleLowerCase","toLowerCase","indexOf","_Fragment","ref","container","left","visibility","type","placeholder","autoFocus","value","onChange"],"mappings":"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"}