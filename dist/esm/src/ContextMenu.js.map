{"version":3,"file":"ContextMenu.js","sources":["../../../src/ContextMenu.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport css from './ContextMenu.module.css'\nimport { useTheme } from \"./ThemeProvider\";\n\nconst ContextMenuList = ({ isFiltered, options, onSelectOption, style }) => {\n  const [activeSubmenu, setActiveSubmenu] = useState(null)\n  const [activeSubmenuPosition, setActiveSubmenuPosition] = useState(null)\n  const [submenuDirection, setSubmenuDirection] = useState('left')\n  const [submenuDirectionVertical, setSubmenuDirectionVertical] = useState('top')\n\n  const handleMenuItemMouseEnter = (e, parentId) => {\n    setActiveSubmenu(parentId);\n    const pos = e.currentTarget.getBoundingClientRect().top - e.currentTarget.parentNode.getBoundingClientRect().top\n    setActiveSubmenuPosition(pos);\n\n    const viewportWidth = window.innerWidth;\n    const submenuWidth = e.target.getBoundingClientRect().width;\n\n    const viewportHeight = window.innerHeight;\n    const submenuHeight = e.target.getBoundingClientRect().height;\n\n    const rightEdge = e.currentTarget.getBoundingClientRect().right;\n    if (rightEdge + submenuWidth > viewportWidth) {\n      setSubmenuDirection(\"right\");\n    } else {\n      setSubmenuDirection(\"left\");\n    }\n\n    const bottomEdge = e.currentTarget.getBoundingClientRect().bottom;\n    if (bottomEdge + submenuHeight > viewportHeight) {\n      setSubmenuDirectionVertical(\"bottom\");\n    } else {\n      setSubmenuDirectionVertical(\"top\");\n    }\n  };\n\n  const handleMenuItemMouseLeave = () => {\n    setActiveSubmenu(null);\n  };\n\n  return (\n    <ul className={css.contextMenu} style={style}>\n      {options?.filter(isFiltered)?.map((option, index) => {\n        if (option.separator === true)\n          return <li key={`${option.id}-${index}`} ><hr /></li>\n\n        return <li\n          key={`${option.label}-${index}`}\n          onClick={() => onSelectOption(option)}\n          onMouseEnter={(e) => handleMenuItemMouseEnter(e, option.label)}\n          onMouseLeave={() => handleMenuItemMouseLeave()}\n        >\n          <div className={css.contextMenuItemContainer}>\n            <div className={css.contextMenuItemLabelContainer}>\n              <div className={css.contextMenuItemLabel} style={option.style}>{option.label}</div>\n              {option.description && <div className={css.contextMenuItemDescription}>{option.description}</div>}\n            </div>\n            {option.children && <div className={css.contextMenuItemSubMenu}>â–¶</div>}\n          </div>\n\n          {option.children && option.label === activeSubmenu && (\n              <ContextMenuList\n                isFiltered={isFiltered}\n                options={option.children.map((o) => ({ ...o, _parent: option }))}\n                onSelectOption={onSelectOption}\n                className={css.submenu}\n                style={{\n                  [submenuDirection]: '100%', \n                  top: submenuDirectionVertical === 'top' ? activeSubmenuPosition : null, \n                  bottom: submenuDirectionVertical === 'bottom' ? 0 : null \n                }}/>\n            )}\n        </li>\n      })}\n    </ul>\n  )\n}\n\n\nexport const ContextMenu = ({ children }) => {\n  const { currentTheme } = useTheme()\n\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [options, setOptions] = useState(null);\n  const [search, setSearch] = useState('')\n\n  const menuRef = useRef(null);\n  const searchRef = useRef(null);\n\n  const handleContextMenu = (e, options) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    setTimeout(() => searchRef.current?.focus(), 0)\n    \n    setOptions(options);\n    setPosition({ x: e.clientX, y: e.clientY });\n  };\n\n  const handleMenuItemClick = (option) => {\n    option.onClick?.(option)\n    setSearch('')\n    setOptions(null)\n  };\n\n  const handleOutsideClick = (e) => {\n    if (menuRef.current && !menuRef.current.contains(e.target)) {\n      setSearch('')\n      setOptions(null);\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener('mousedown', handleOutsideClick);\n    return () => {\n      document.removeEventListener('mousedown', handleOutsideClick);\n    };\n  }, []);\n\n  const isFiltered = (option) => {\n    if (!search?.length)\n      return true\n\n    const _search = search.toLocaleLowerCase()\n\n    if ((option.label?.toLowerCase()?.indexOf(_search) ?? -1) > -1)\n      return true\n\n    if ((option.description?.toLowerCase()?.indexOf(_search) ?? -1) > -1)\n      return true\n\n    return false\n  }\n\n  return (\n    <>\n      {children({ handleContextMenu })}\n      {options?.length ? <div ref={menuRef} className={css.container} style={{ left: position.x, top: position.y, visibility: options ? 'visible' : 'hidden' }}>\n        <input ref={searchRef} type=\"text\" placeholder=\"Buscar...\" autoFocus value={search ?? ''} onChange={(e) => setSearch(e.target.value)} />\n        <ContextMenuList isFiltered={isFiltered} options={options} onSelectOption={handleMenuItemClick} style={{position: 'relative'}}/>\n      </div> : null}\n    </>\n  )\n};"],"names":["ContextMenuList","_ref","_options$filter","isFiltered","options","onSelectOption","style","activeSubmenu","setActiveSubmenu","useState","activeSubmenuPosition","setActiveSubmenuPosition","submenuDirection","setSubmenuDirection","submenuDirectionVertical","setSubmenuDirectionVertical","handleMenuItemMouseEnter","e","parentId","pos","currentTarget","getBoundingClientRect","top","parentNode","viewportWidth","window","innerWidth","submenuWidth","target","width","viewportHeight","innerHeight","submenuHeight","height","rightEdge","right","bottomEdge","bottom","handleMenuItemMouseLeave","_jsx","className","css","contextMenu","children","filter","map","option","index","separator","concat","id","_jsxs","onClick","onMouseEnter","label","onMouseLeave","contextMenuItemContainer","contextMenuItemLabelContainer","contextMenuItemLabel","description","contextMenuItemDescription","contextMenuItemSubMenu","o","_objectSpread","_parent","submenu","ContextMenu","_ref2","useTheme","position","setPosition","x","y","setOptions","search","setSearch","menuRef","useRef","searchRef","handleContextMenu","preventDefault","stopPropagation","setTimeout","_searchRef$current","current","focus","clientX","clientY","handleMenuItemClick","_option$onClick","call","handleOutsideClick","contains","useEffect","document","addEventListener","removeEventListener","_option$label$toLower","_option$label","_option$label$toLower2","_option$description$t","_option$description","_option$description$t2","length","_search","toLocaleLowerCase","toLowerCase","indexOf","_Fragment","ref","container","left","visibility","type","placeholder","autoFocus","value","onChange"],"mappings":"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"}