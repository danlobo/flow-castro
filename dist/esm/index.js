import e,{useState as n,createContext as t,useContext as o,useEffect as i,memo as r,useMemo as s,useRef as a,useCallback as l,useImperativeHandle as c}from"react";import{jsx as u,jsxs as d,Fragment as p}from"react/jsx-runtime";const f=t(null),m=({children:e})=>{const[t,o]=n(null);return u(f.Provider,{value:{dragInfo:t,setDragInfo:o},children:e})},y=()=>{const{dragInfo:e,setDragInfo:n}=o(f);return{dragInfo:e,setDragInfo:n}},v=t(),h=({children:e,initialState:t,store:o})=>{const[i,r]=n(t?.scale||1),[s,a]=n(t?.position||{x:0,y:0});return u(v.Provider,{value:{scale:i,setScale:r,position:s,setPosition:a},children:e})},g=()=>{const{scale:e,setScale:n,position:t,setPosition:i}=o(v);return{scale:e,setScale:n,position:t,setPosition:i}};var x={port:"NodePort-module_port__aKb8R",input:"NodePort-module_input__nP24E",output:"NodePort-module_output__Q8Uf2",portOverlay:"NodePort-module_portOverlay__mjlyG",label:"NodePort-module_label__4Kc0j",formContainer:"NodePort-module_formContainer__lna8k",portConnector:"NodePort-module_portConnector__4GyCZ",circle:"NodePort-module_circle__3fRNv",square:"NodePort-module_square__QSRn2",diamond:"NodePort-module_diamond__NHCFW"};const b=(e,...n)=>{if(!n.length)return e;const t=n.shift();if(w(e)&&w(t))for(const n in t)w(t[n])?(e[n]||Object.assign(e,{[n]:{}}),b(e[n],t[n])):Object.assign(e,{[n]:t[n]});return b(e,...n)};function w(e){return e&&"object"==typeof e&&!Array.isArray(e)}function C(e){const n={roundness:0,nodes:{common:{padding:2,borderRadius:4,boxShadow:"0 0 8px rgba(0, 0, 0, 0.125)",title:{background:e.colors.hover,color:e.colors.text},body:{background:e.colors.background,border:`1px solid ${e.colors.border}`,color:e.colors.text}}},ports:{},connections:{},buttons:{default:{backgroundColor:e.colors.background,border:`1px solid ${e.colors.border}`,color:e.colors.text}},contextMenu:{background:e.colors.background,border:`1px solid ${e.colors.border}`,color:e.colors.text}};return b({},n,e)}const S={light:C({colors:{primary:"#0000ff",secondary:"#00ff00",background:"#ffffff44",text:"#222222",hover:"#f2f2f2",border:"#888",selectionBorder:"#888"}}),dark:C({colors:{primary:"#000088",secondary:"#008800",background:"#222",text:"#DDD",hover:"#333",border:"#888",selectionBorder:"#aaa"}})},P={themeName:"light",currentTheme:S.light,setThemeName:e=>{console.log("setThemeName not initialized")}},M=e.createContext(P),N=({children:e,themes:t,theme:o="light"})=>{const[r,s]=n(S[o]||S.light),[a,l]=n(o);return i((()=>{const e=b({},S[a],t?.[a],t?.common);s(e)}),[a,t]),i((()=>{l(o||"light")}),[o]),r?u(M.Provider,{value:{themeName:a,currentTheme:r,setThemeName:l},children:e}):null},T=()=>e.useContext(M),H=(e,n,t,o)=>({x:e/o,y:n/o});function V({name:e,type:t,nodeId:o,label:r,hidePort:c,onConnected:p,isConnected:f,direction:m,value:v,onValueChange:h,canMove:b,options:w}){var C,S,P,M,N,V,_;const{currentTheme:E}=T(),{position:O,scale:k}=g(),{dragInfo:I,setDragInfo:L}=y(),[Y,z]=n(v),A=s((()=>({circle:x.circle,square:x.square,diamond:x.diamond})),[]);i((()=>{if(!e)throw new Error("Port name is required. NodeId: "+o)}),[e]),i((()=>{}),[Y]),i((()=>{f&&h?.(null)}),[f]);const j=a(null),X=a(null);l((e=>{e.preventDefault(),e.stopPropagation(),h?.(Y)}),[Y]);const W=a();i((()=>{X.current&&(W.current=X.current.getBoundingClientRect())}),[X.current]);const R=a();i((()=>{j.current&&(R.current=j.current.getBoundingClientRect())}),[j.current]);const[$,B]=n({x:0,y:0});return d("div",{ref:j,style:{cursor:!c&&b?"crosshair":null},className:[x.port,x[m]].join(" "),onMouseDown:n=>{if(c||!b)return;n.stopPropagation();const i=j.current.getBoundingClientRect();H(n.pageX-i.left,n.pageY-i.top,0,k);const r=X.current.getBoundingClientRect(),s={type:"connector",nodeId:o,portName:e,portType:t,startX:r.left,startY:r.top};L(s);const a=e=>{if(!s)return;if("connector"!==s.type)return;const n=H(e.pageX-i.left,e.pageY-i.top,0,k);B({x:n.x,y:n.y})},l=n=>{if(window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",l),L(null),!s)return;const i=document.elementsFromPoint(n.pageX-window.scrollX,n.pageY-window.scrollY).find((e=>e.classList?.contains(x.portOverlay)&&e.dataset.portDirection.toString()!==m.toString()&&e.dataset.portType.toString()===t.type?.toString()));i&&p?.({source:{nodeId:o,portName:e},target:{nodeId:i.dataset.nodeId,portName:i.dataset.portName}})};window.addEventListener("mousemove",a),window.addEventListener("mouseup",l)},children:[!c&&u("div",{className:[x.portOverlay,x[m]].join(" "),id:`card-${o}-${m}-${e}-overlay`,"data-port-name":e,"data-port-type":t.type,"data-port-direction":m,"data-node-id":o}),u("div",{className:x.label,style:{justifyContent:"input"===m?"flex-start":"flex-end"},children:u("span",{children:r})}),u("div",{className:x.formContainer,onMouseDown:e=>{e.stopPropagation()},children:null!==(C="input"===m&&!f&&t.render?.({value:v,onChange:h,options:w}))&&void 0!==C?C:null}),!c&&u("div",{id:`card-${o}-${m}-${e}`,ref:X,"data-port-connector-name":e,"data-port-connector-type":t.type,"data-port-connector-direction":m,"data-port-connector-connected":Boolean(f),style:{background:null!==(S=null!==(P=null!==(M=E.ports?.[null!==(N=t?.type)&&void 0!==N?N:"default"]?.color)&&void 0!==M?M:t?.color)&&void 0!==P?P:E.ports?.default?.color)&&void 0!==S?S:E.colors?.primary},className:[x.portConnector,x[m],null!==(V=A[null!==(_=t?.shape)&&void 0!==_?_:"circle"])&&void 0!==V?V:null].filter(Boolean).join(" ")})]})}var _=r(V),E={node:"Node-module_node__yVhqG",selected:"Node-module_selected__bA-o1",title:"Node-module_title__IkogO",container:"Node-module_container__PfJft",portsContainer:"Node-module_portsContainer__3s5BH",inputPortsContainer:"Node-module_inputPortsContainer__FPkYh",outputPortsContainer:"Node-module_outputPortsContainer__qYiul"};function O({name:e,portTypes:n,nodeType:t,value:o,canMove:r,isSelected:c,onChangePosition:p,onDragStart:f,onDragEnd:m,onConnect:y,containerRef:v,onContextMenu:h,onResize:x,onValueChange:b,debugMode:w}){var C,S,P,M,N;const{currentTheme:H}=T(),V=a();i((()=>{const e=V.current,n=new ResizeObserver((e=>{x({width:e[0].contentRect.width,height:e[0].contentRect.height})}));return n.observe(e),()=>{n.unobserve(e)}}),[]);const{id:O,name:k,position:I,values:L}=o;i((()=>{if(null==O)throw new Error("Node id is required");if(null==e)throw new Error("Node name is required");e!==k&&console.warn("Node name mismatch",e,k)}),[e,k,O]);const{scale:Y}=g(),z=l((e=>{if(!r)return;e.stopPropagation();const n=e.pageX,t=e.pageY;f?.({x:I.x,y:I.y});const o=e=>{const o=e.pageX-n,i=e.pageY-t;p({x:I.x+o/Y,y:I.y+i/Y})},i=e=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",i);const r=e.pageX-n,s=e.pageY-t;Math.abs(r)>=2&&Math.abs(s)>=2&&m?.({x:I.x+r/Y,y:I.y+s/Y})};window.addEventListener("mousemove",o),window.addEventListener("mouseup",i)}),[I,Y,p,f,m]),A=l((({source:e,target:n})=>{y?.({source:e,target:n})}),[y]),j=l((({source:e,target:n})=>{y?.({source:n,target:e})}),[y]),X=s((()=>"function"==typeof t.inputs?t.inputs(L):t.inputs),[t,L]);i((()=>{if(null==X)return;if(null==L)return;const e=Object.keys(L).filter((e=>!X.some((n=>n.name===e))));if(e.length>0){const n=Object.keys(L).filter((n=>!e.includes(n))).reduce(((e,n)=>(e[n]=L[n],e)),{});b?.({...o,values:n})}}),[X]);const W=s((()=>"function"==typeof t.outputs?t.outputs(L,o.connections?.inputs):t.outputs),[t,L,o.connections?.inputs]);return d("div",{ref:V,id:`card-${O}`,className:[E.node,c?E.selected:""].join(" "),style:{backgroundColor:null!==(C=H?.nodes?.[t?.type]?.body?.background)&&void 0!==C?C:H?.nodes?.common?.body?.background,border:null!==(S=H?.nodes?.[t?.type]?.body?.border)&&void 0!==S?S:H?.nodes?.common?.body?.border,color:null!==(P=H?.nodes?.[t?.type]?.body?.color)&&void 0!==P?P:H?.nodes?.common?.body?.color,transform:`translate(${I.x}px, ${I.y}px)`,cursor:r?"grab":null},onMouseDown:z,onContextMenu:h,children:[u("div",{className:E.title,style:{backgroundColor:null!==(M=H?.nodes?.[t?.type]?.title?.background)&&void 0!==M?M:H?.nodes?.common?.title?.background,color:null!==(N=H?.nodes?.[t?.type]?.title?.color)&&void 0!==N?N:H?.nodes?.common?.title?.color},children:u("h3",{style:{textAlign:"center"},children:w?O:e})}),d("div",{className:E.container,children:[u("div",{className:[E.portsContainer,E.inputPortsContainer].join(" "),children:X?.map((e=>{const t=n[e.type],i=null!=e.hidePort?e.hidePort:t.hidePort;return u(_,{name:e.name,value:L[e.name],onValueChange:n=>{b?.({...o,values:{...o.values,[e.name]:n}})},nodeId:O,type:n[e.type],direction:"input",label:e.label,hidePort:Boolean(i),containerRef:v,isConnected:o.connections?.inputs?.some((n=>n.name===e.name)),onConnected:j,canMove:r,options:e.options},e.name)}))}),u("div",{className:[E.portsContainer,E.outputPortsContainer].join(" "),children:W?.map((e=>u(_,{name:e.name,nodeId:O,type:n[e.type],direction:"output",label:e.label,containerRef:v,isConnected:o.connections?.outputs?.some((n=>n.name===e.name)),onConnected:A,canMove:r,options:e.options},e.name)))})]})]},`card-${O}`)}var k=r(O),I=function(e,n){return Number(e.toFixed(n))},L=function(e,n,t){t&&"function"==typeof t&&t(e,n)},Y={easeOut:function(e){return-Math.cos(e*Math.PI)/2+.5},linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},z=function(e){"number"==typeof e&&cancelAnimationFrame(e)},A=function(e){e.mounted&&(z(e.animation),e.animate=!1,e.animation=null,e.velocity=null)};function j(e,n,t,o){if(e.mounted){var i=(new Date).getTime();A(e),e.animation=function(){if(!e.mounted)return z(e.animation);var r=(new Date).getTime()-i,s=r/t,a=(0,Y[n])(s);r>=t?(o(1),e.animation=null):e.animation&&(o(a),requestAnimationFrame(e.animation))},requestAnimationFrame(e.animation)}}function X(e,n,t,o){var i=function(e){var n=e.scale,t=e.positionX,o=e.positionY;return!(Number.isNaN(n)||Number.isNaN(t)||Number.isNaN(o))}(n);if(e.mounted&&i){var r=e.setTransformState,s=e.transformState,a=s.scale,l=s.positionX,c=s.positionY,u=n.scale-a,d=n.positionX-l,p=n.positionY-c;0===t?r(n.scale,n.positionX,n.positionY):j(e,o,t,(function(e){r(a+u*e,l+d*e,c+p*e)}))}}var W=function(e,n){var t=e.wrapperComponent,o=e.contentComponent,i=e.setup.centerZoomedOut;if(!t||!o)throw new Error("Components are not mounted");var r=function(e,n,t){var o=e.offsetWidth,i=e.offsetHeight,r=n.offsetWidth*t,s=n.offsetHeight*t;return{wrapperWidth:o,wrapperHeight:i,newContentWidth:r,newDiffWidth:o-r,newContentHeight:s,newDiffHeight:i-s}}(t,o,n),s=r.wrapperWidth,a=r.wrapperHeight,l=function(e,n,t,o,i,r,s){var a=e>n?t*(s?1:.5):0,l=o>i?r*(s?1:.5):0;return{minPositionX:e-n-a,maxPositionX:a,minPositionY:o-i-l,maxPositionY:l}}(s,r.newContentWidth,r.newDiffWidth,a,r.newContentHeight,r.newDiffHeight,Boolean(i));return l},R=function(e,n,t,o){return I(o?e<n?n:e>t?t:e:e,2)},$=function(e,n){var t=W(e,n);return e.bounds=t,t};function B(e,n,t,o,i,r,s){var a=t.minPositionX,l=t.minPositionY,c=t.maxPositionX,u=t.maxPositionY,d=0,p=0;return s&&(d=i,p=r),{x:R(e,a-d,c+d,o),y:R(n,l-p,u+p,o)}}function D(e,n,t,o,i,r){var s=e.transformState,a=s.scale,l=s.positionX,c=s.positionY,u=o-a;return"number"!=typeof n||"number"!=typeof t?(console.error("Mouse X and Y position were not provided!"),{x:l,y:c}):B(l-n*u,c-t*u,i,r,0,0,null)}function F(e,n,t,o,i){var r=n-(i?o:0);return!Number.isNaN(t)&&e>=t?t:!Number.isNaN(n)&&e<=r?r:e}var Z=function(e,n){var t=e.setup.panning.excluded,o=e.isInitialized,i=e.wrapperComponent,r=n.target,s=null==i?void 0:i.contains(r);return!!(o&&r&&s)&&!Me(r,t)},K=function(e){var n=e.isInitialized,t=e.isPanning,o=e.setup.panning.disabled;return!(!n||!t||o)};var q=function(e,n){var t=e.setup,o=e.transformState.scale,i=t.minScale,r=t.disablePadding;return n>0&&o>=i&&!r?n:0},J=function(e){var n=e.mounted,t=e.setup,o=t.disabled,i=t.velocityAnimation,r=e.transformState.scale;return!(i.disabled&&!(r>1)&&o&&!n)},U=function(e){var n=e.mounted,t=e.velocity,o=e.bounds,i=e.setup,r=i.disabled,s=i.velocityAnimation,a=e.transformState.scale;return!(s.disabled&&!(a>1)&&r&&!n)&&!(!t||!o)};function Q(e,n,t,o,i,r,s,a,l,c){if(i){var u;if(n>s&&t>s)return(u=s+(e-s)*c)>l?l:u<s?s:u;if(n<r&&t<r)return(u=r+(e-r)*c)<a?a:u>r?r:u}return o?n:R(e,r,s,i)}function G(e,n){if(J(e)){var t=e.lastMousePosition,o=e.velocityTime,i=e.setup,r=e.wrapperComponent,s=i.velocityAnimation.equalToMove,a=Date.now();if(t&&o&&r){var l=function(e,n){return n?Math.min(1,e.offsetWidth/window.innerWidth):1}(r,s),c=n.x-t.x,u=n.y-t.y,d=c/l,p=u/l,f=a-o,m=c*c+u*u,y=Math.sqrt(m)/f;e.velocity={velocityX:d,velocityY:p,total:y}}e.lastMousePosition=n,e.velocityTime=a}}function ee(e,n){var t=e.transformState.scale;A(e),$(e,t),void 0!==window.TouchEvent&&n instanceof TouchEvent?function(e,n){var t=n.touches,o=e.transformState,i=o.positionX,r=o.positionY;if(e.isPanning=!0,1===t.length){var s=t[0].clientX,a=t[0].clientY;e.startCoords={x:s-i,y:a-r}}}(e,n):function(e,n){var t=e.transformState,o=t.positionX,i=t.positionY;e.isPanning=!0;var r=n.clientX,s=n.clientY;e.startCoords={x:r-o,y:s-i}}(e,n)}function ne(e){var n=e.transformState.scale,t=e.setup,o=t.minScale,i=t.alignmentAnimation,r=i.disabled,s=i.sizeX,a=i.sizeY,l=i.animationTime,c=i.animationType;if(!(r||n<o||!s&&!a)){var u=function(e){var n=e.transformState,t=n.positionX,o=n.positionY,i=n.scale,r=e.setup,s=r.disabled,a=r.limitToBounds,l=r.centerZoomedOut,c=e.wrapperComponent;if(!s&&c&&e.bounds){var u=e.bounds,d=u.maxPositionX,p=u.minPositionX,f=u.maxPositionY,m=u.minPositionY,y=t>d||t<p,v=o>f||o<m,h=D(e,t>d?c.offsetWidth:e.setup.minPositionX||0,o>f?c.offsetHeight:e.setup.minPositionY||0,i,e.bounds,a||l),g=h.x,x=h.y;return{scale:i,positionX:y?g:t,positionY:v?x:o}}}(e);u&&X(e,u,l,c)}}function te(e,n,t){var o=e.startCoords,i=e.setup.alignmentAnimation,r=i.sizeX,s=i.sizeY;if(o){var a=function(e,n,t){var o=e.startCoords,i=e.transformState,r=e.setup.panning,s=r.lockAxisX,a=r.lockAxisY,l=i.positionX,c=i.positionY;if(!o)return{x:l,y:c};var u=n-o.x,d=t-o.y;return{x:s?l:u,y:a?c:d}}(e,n,t),l=a.x,c=a.y,u=q(e,r),d=q(e,s);G(e,{x:l,y:c}),function(e,n,t,o,i){var r=e.setup.limitToBounds,s=e.wrapperComponent,a=e.bounds,l=e.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(null!==s&&null!==a&&(n!==u||t!==d)){var p=B(n,t,a,r,o,i,s),f=p.x,m=p.y;e.setTransformState(c,f,m)}}(e,l,c,u,d)}}function oe(e){if(e.isPanning){var n=e.setup.panning.velocityDisabled,t=e.velocity,o=e.wrapperComponent,i=e.contentComponent;e.isPanning=!1,e.animate=!1,e.animation=null;var r=null==o?void 0:o.getBoundingClientRect(),s=null==i?void 0:i.getBoundingClientRect(),a=(null==r?void 0:r.width)||0,l=(null==r?void 0:r.height)||0,c=(null==s?void 0:s.width)||0,u=(null==s?void 0:s.height)||0,d=a<c||l<u;!n&&t&&(null==t?void 0:t.total)>.1&&d?function(e){var n=e.velocity,t=e.bounds,o=e.setup,i=e.wrapperComponent;if(U(e)&&n&&t&&i){var r=n.velocityX,s=n.velocityY,a=n.total,l=t.maxPositionX,c=t.minPositionX,u=t.maxPositionY,d=t.minPositionY,p=o.limitToBounds,f=o.alignmentAnimation,m=o.zoomAnimation,y=o.panning,v=y.lockAxisY,h=y.lockAxisX,g=m.animationType,x=f.sizeX,b=f.sizeY,w=f.velocityAlignmentTime,C=function(e,n){var t=e.setup.velocityAnimation,o=t.equalToMove,i=t.animationTime,r=t.sensitivity;return o?i*n*r:i}(e,a),S=Math.max(C,w),P=q(e,x),M=q(e,b),N=P*i.offsetWidth/100,T=M*i.offsetHeight/100,H=l+N,V=c-N,_=u+T,E=d-T,O=e.transformState,k=(new Date).getTime();j(e,g,S,(function(n){var t=e.transformState,o=t.scale,i=t.positionX,a=t.positionY,m=((new Date).getTime()-k)/w,y=1-(0,Y[f.animationType])(Math.min(1,m)),g=1-n,x=i+r*g,b=a+s*g,C=Q(x,O.positionX,i,h,p,c,l,V,H,y),S=Q(b,O.positionY,a,v,p,d,u,E,_,y);i===x&&a===b||e.setTransformState(o,C,S)}))}}(e):ne(e)}}function ie(e,n,t,o){var i=e.setup,r=i.minScale,s=i.maxScale,a=i.limitToBounds,l=F(I(n,2),r,s,0,!1),c=D(e,t,o,l,$(e,l),a);return{scale:l,positionX:c.x,positionY:c.y}}function re(e,n,t){var o=e.transformState.scale,i=e.wrapperComponent,r=e.setup,s=r.minScale,a=r.limitToBounds,l=r.zoomAnimation,c=l.disabled,u=l.animationTime,d=l.animationType,p=c||o>=s;if((o>=1||a)&&ne(e),!p&&i&&e.mounted){var f=ie(e,s,n||i.offsetWidth/2,t||i.offsetHeight/2);f&&X(e,f,u,d)}}var se=function(){return se=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},se.apply(this,arguments)};function ae(e,n,t){if(t||2===arguments.length)for(var o,i=0,r=n.length;i<r;i++)!o&&i in n||(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))}var le=1,ce=0,ue=0,de={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,wheel:{step:.2,disabled:!1,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},pe=function(e){var n,t,o,i;return{previousScale:null!==(n=e.initialScale)&&void 0!==n?n:le,scale:null!==(t=e.initialScale)&&void 0!==t?t:le,positionX:null!==(o=e.initialPositionX)&&void 0!==o?o:ce,positionY:null!==(i=e.initialPositionY)&&void 0!==i?i:ue}},fe=function(e){var n=se({},de);return Object.keys(e).forEach((function(t){var o=void 0!==e[t];if(void 0!==de[t]&&o){var i=Object.prototype.toString.call(de[t]),r="[object Object]"===i,s="[object Array]"===i;n[t]=r?se(se({},de[t]),e[t]):s?ae(ae([],de[t],!0),e[t],!0):e[t]}})),n},me=function(e,n,t){var o=e.transformState.scale,i=e.wrapperComponent,r=e.setup,s=r.maxScale,a=r.minScale,l=r.zoomAnimation.size;if(!i)throw new Error("Wrapper is not mounted");var c=o*Math.exp(n*t);return F(I(c,3),a,s,l,!1)};function ye(e,n,t,o,i){var r=e.wrapperComponent,s=e.transformState,a=s.scale,l=s.positionX,c=s.positionY;if(!r)return console.error("No WrapperComponent found");var u=(r.offsetWidth/2-l)/a,d=(r.offsetHeight/2-c)/a,p=ie(e,me(e,n,t),u,d);if(!p)return console.error("Error during zoom event. New transformation state was not calculated.");X(e,p,o,i)}function ve(e,n,t,o){var i=e.setup,r=e.wrapperComponent,s=i.limitToBounds,a=pe(e.props),l=e.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(r){var p=W(e,a.scale),f=B(a.positionX,a.positionY,p,s,0,0,r),m={scale:a.scale,positionX:f.x,positionY:f.y};c===a.scale&&u===a.positionX&&d===a.positionY||(null==o||o(),X(e,m,n,t))}}var he=function(e){return function(n,t,o){void 0===n&&(n=.5),void 0===t&&(t=300),void 0===o&&(o="easeOut"),ye(e,1,n,t,o)}},ge=function(e){return function(n,t,o){void 0===n&&(n=.5),void 0===t&&(t=300),void 0===o&&(o="easeOut"),ye(e,-1,n,t,o)}},xe=function(e){return function(n,t,o,i,r){void 0===i&&(i=300),void 0===r&&(r="easeOut");var s=e.transformState,a=s.positionX,l=s.positionY,c=s.scale,u=e.wrapperComponent,d=e.contentComponent;if(!e.setup.disabled&&u&&d){var p={positionX:Number.isNaN(n)?a:n,positionY:Number.isNaN(t)?l:t,scale:Number.isNaN(o)?c:o};X(e,p,i,r)}}},be=function(e){return function(n,t){void 0===n&&(n=200),void 0===t&&(t="easeOut"),ve(e,n,t)}},we=function(e){return function(n,t,o){void 0===t&&(t=200),void 0===o&&(o="easeOut");var i=e.transformState,r=e.wrapperComponent,s=e.contentComponent;if(r&&s){var a=Te(n||i.scale,r,s);X(e,a,t,o)}}},Ce=function(e){return function(n,t,o,i){void 0===o&&(o=600),void 0===i&&(i="easeOut"),A(e);var r=e.wrapperComponent,s="string"==typeof n?document.getElementById(n):n;if(r&&s&&r.contains(s)){var a=function(e,n,t){var o=e.wrapperComponent,i=e.contentComponent,r=e.transformState,s=e.setup,a=s.limitToBounds,l=s.minScale,c=s.maxScale;if(!o||!i)return r;var u,d,p,f,m,y,v,h,g=o.getBoundingClientRect(),x=n.getBoundingClientRect(),b=(u=o,d=i,p=r,f=n.getBoundingClientRect(),m=u.getBoundingClientRect(),y=d.getBoundingClientRect(),v=m.x*p.scale,h=m.y*p.scale,{x:(f.x-y.x+v)/p.scale,y:(f.y-y.y+h)/p.scale}),w=b.x,C=b.y,S=x.width/r.scale,P=x.height/r.scale,M=o.offsetWidth/S,N=o.offsetHeight/P,T=F(t||Math.min(M,N),l,c,0,!1),H=(g.width-S*T)/2,V=(g.height-P*T)/2,_=B((g.left-w)*T+H,(g.top-C)*T+V,W(e,T),a,0,0,o);return{positionX:_.x,positionY:_.y,scale:T}}(e,s,t);X(e,a,o,i)}}},Se=function(e){return{instance:e,state:e.transformState,zoomIn:he(e),zoomOut:ge(e),setTransform:xe(e),resetTransform:be(e),centerView:we(e),zoomToElement:Ce(e)}};function Pe(){try{return{get passive(){return!0,!1}}}catch(e){return!1}}var Me=function(e,n){var t=e.tagName.toUpperCase();return!!n.find((function(e){return e.toUpperCase()===t}))||!!n.find((function(n){return e.classList.contains(n)}))},Ne=function(e){e&&clearTimeout(e)},Te=function(e,n,t){var o=t.offsetWidth*e,i=t.offsetHeight*e;return{scale:e,positionX:(n.offsetWidth-o)/2,positionY:(n.offsetHeight-i)/2}};function He(e,n,t){var o=n.getBoundingClientRect(),i=0,r=0;if("clientX"in e)i=(e.clientX-o.left)/t,r=(e.clientY-o.top)/t;else{var s=e.touches[0];i=(s.clientX-o.left)/t,r=(s.clientY-o.top)/t}return(Number.isNaN(i)||Number.isNaN(r))&&console.error("No mouse or touch offset found"),{x:i,y:r}}var Ve=function(e){return Math.sqrt(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2))},_e=function(e,n){var t=e.props,o=t.onWheel,i=t.onZoom,r=e.contentComponent,s=e.setup,a=e.transformState.scale,l=s.limitToBounds,c=s.centerZoomedOut,u=s.zoomAnimation,d=s.wheel,p=s.disablePadding,f=u.size,m=u.disabled,y=d.step;if(!r)throw new Error("Component not mounted");n.preventDefault(),n.stopPropagation();var v=function(e,n){var t,o,i=function(e){return e?e.deltaY<0?1:-1:0}(e);return o=i,"number"==typeof(t=n)?t:o}(n,null),h=function(e,n,t,o,i){var r=e.transformState.scale,s=e.wrapperComponent,a=e.setup,l=a.maxScale,c=a.minScale,u=a.zoomAnimation,d=a.disablePadding,p=u.size,f=u.disabled;if(!s)throw new Error("Wrapper is not mounted");var m=r+n*(r-r*t)*t;if(i)return m;var y=!o&&!f;return F(I(m,3),c,l,p,y&&!d)}(e,v,y,!n.ctrlKey);if(a!==h){var g=$(e,h),x=He(n,r,a),b=l&&(m||0===f||c||p),w=D(e,x.x,x.y,h,g,b),C=w.x,S=w.y;e.previousWheelEvent=n,e.setTransformState(h,C,S),L(Se(e),n,o),L(Se(e),n,i)}},Ee=function(e,n){var t=e.props,o=t.onWheelStop,i=t.onZoomStop;Ne(e.wheelAnimationTimer),e.wheelAnimationTimer=setTimeout((function(){e.mounted&&(re(e,n.x,n.y),e.wheelAnimationTimer=null)}),100);var r=function(e,n){var t=e.previousWheelEvent,o=e.transformState.scale,i=e.setup,r=i.maxScale,s=i.minScale;return!!t&&(o<r||o>s||Math.sign(t.deltaY)!==Math.sign(n.deltaY)||t.deltaY>0&&t.deltaY<n.deltaY||t.deltaY<0&&t.deltaY>n.deltaY||Math.sign(t.deltaY)!==Math.sign(n.deltaY))}(e,n);r&&(Ne(e.wheelStopEventTimer),e.wheelStopEventTimer=setTimeout((function(){e.mounted&&(e.wheelStopEventTimer=null,L(Se(e),n,o),L(Se(e),n,i))}),160))},Oe=function(e,n){var t=e.contentComponent,o=e.pinchStartDistance,i=e.transformState.scale,r=e.setup,s=r.limitToBounds,a=r.centerZoomedOut,l=r.zoomAnimation,c=l.disabled,u=l.size;if(null!==o&&t){var d=function(e,n,t){var o=t.getBoundingClientRect(),i=e.touches,r=I(i[0].clientX-o.left,5),s=I(i[0].clientY-o.top,5);return{x:(r+I(i[1].clientX-o.left,5))/2/n,y:(s+I(i[1].clientY-o.top,5))/2/n}}(n,i,t);if(Number.isFinite(d.x)&&Number.isFinite(d.y)){var p=Ve(n),f=function(e,n){var t=e.pinchStartScale,o=e.pinchStartDistance,i=e.setup,r=i.maxScale,s=i.minScale,a=i.zoomAnimation,l=i.disablePadding,c=a.size,u=a.disabled;if(!t||null===o||!n)throw new Error("Pinch touches distance was not provided");return n<0?e.transformState.scale:F(I(n/o*t,2),s,r,c,!u&&!l)}(e,p);if(f!==i){var m=$(e,f),y=s&&(c||0===u||a),v=D(e,d.x,d.y,f,m,y),h=v.x,g=v.y;e.pinchMidpoint=d,e.lastDistance=p,e.setTransformState(f,h,g)}}}},ke=function(e,n){var t=e.props.onZoomStop,o=e.setup.doubleClick.animationTime;Ne(e.doubleClickStopEventTimer),e.doubleClickStopEventTimer=setTimeout((function(){e.doubleClickStopEventTimer=null,L(Se(e),n,t)}),o)};function Ie(e,n){var t=e.setup,o=e.doubleClickStopEventTimer,i=e.transformState,r=e.contentComponent,s=i.scale,a=e.props,l=a.onZoomStart,c=a.onZoom,u=t.doubleClick,d=u.disabled,p=u.mode,f=u.step,m=u.animationTime,y=u.animationType;if(!d&&!o){if("reset"===p)return function(e,n){var t=e.props,o=t.onZoomStart,i=t.onZoom,r=e.setup.doubleClick,s=r.animationTime,a=r.animationType;L(Se(e),n,o),ve(e,s,a,(function(){return L(Se(e),n,i)})),ke(e,n)}(e,n);if(!r)return console.error("No ContentComponent found");var v=me(e,"zoomOut"===p?-1:1,f);if(s!==v){L(Se(e),n,l);var h=He(n,r,s),g=ie(e,v,h.x,h.y);if(!g)return console.error("Error during zoom event. New transformation state was not calculated.");L(Se(e),n,c),X(e,g,m,y),ke(e,n)}}}var Le=function(e){var n=this;this.mounted=!0,this.onChangeCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){n.initializeWindowEvents()},this.unmount=function(){n.cleanupWindowEvents()},this.update=function(e){$(n,n.transformState.scale),n.setup=fe(e)},this.initializeWindowEvents=function(){var e,t=Pe(),o=null===(e=n.wrapperComponent)||void 0===e?void 0:e.ownerDocument,i=null==o?void 0:o.defaultView;null==i||i.addEventListener("mousedown",n.onPanningStart,t),null==i||i.addEventListener("mousemove",n.onPanning,t),null==i||i.addEventListener("mouseup",n.onPanningStop,t),null==o||o.addEventListener("mouseleave",n.clearPanning,t),null==i||i.addEventListener("keyup",n.setKeyUnPressed,t),null==i||i.addEventListener("keydown",n.setKeyPressed,t)},this.cleanupWindowEvents=function(){var e,t,o=Pe(),i=null===(e=n.wrapperComponent)||void 0===e?void 0:e.ownerDocument,r=null==i?void 0:i.defaultView;null==r||r.removeEventListener("mousedown",n.onPanningStart,o),null==r||r.removeEventListener("mousemove",n.onPanning,o),null==r||r.removeEventListener("mouseup",n.onPanningStop,o),null==i||i.removeEventListener("mouseleave",n.clearPanning,o),null==r||r.removeEventListener("keyup",n.setKeyUnPressed,o),null==r||r.removeEventListener("keydown",n.setKeyPressed,o),document.removeEventListener("mouseleave",n.clearPanning,o),A(n),null===(t=n.observer)||void 0===t||t.disconnect()},this.handleInitializeWrapperEvents=function(e){var t=Pe();e.addEventListener("wheel",n.onWheelZoom,t),e.addEventListener("dblclick",n.onDoubleClick,t),e.addEventListener("touchstart",n.onTouchPanningStart,t),e.addEventListener("touchmove",n.onTouchPanning,t),e.addEventListener("touchend",n.onTouchPanningStop,t)},this.handleInitialize=function(e){var t=n.setup.centerOnInit;n.applyTransformation(),t&&(n.setCenter(),n.observer=new ResizeObserver((function(){var e;n.setCenter(),null===(e=n.observer)||void 0===e||e.disconnect()})),n.observer.observe(e))},this.onWheelZoom=function(e){if(!n.setup.disabled){var t=function(e,n){var t=e.setup.wheel,o=t.disabled,i=t.wheelDisabled,r=t.touchPadDisabled,s=t.excluded,a=e.isInitialized,l=e.isPanning,c=n.target;return!(!a||l||o||!c||i&&!n.ctrlKey||r&&n.ctrlKey||Me(c,s))}(n,e);t&&n.isPressingKeys(n.setup.wheel.activationKeys)&&(function(e,n){var t=e.props,o=t.onWheelStart,i=t.onZoomStart;e.wheelStopEventTimer||(A(e),L(Se(e),n,o),L(Se(e),n,i))}(n,e),_e(n,e),Ee(n,e))}},this.onPanningStart=function(e){var t=n.setup.disabled,o=n.props.onPanningStart;t||Z(n,e)&&n.isPressingKeys(n.setup.panning.activationKeys)&&(e.preventDefault(),e.stopPropagation(),A(n),ee(n,e),L(Se(n),e,o))},this.onPanning=function(e){var t=n.setup.disabled,o=n.props.onPanning;t||K(n)&&n.isPressingKeys(n.setup.panning.activationKeys)&&(e.preventDefault(),e.stopPropagation(),te(n,e.clientX,e.clientY),L(Se(n),e,o))},this.onPanningStop=function(e){var t=n.props.onPanningStop;n.isPanning&&(oe(n),L(Se(n),e,t))},this.onPinchStart=function(e){var t=n.setup.disabled,o=n.props,i=o.onPinchingStart,r=o.onZoomStart;if(!t){var s=function(e,n){var t=e.setup.pinch,o=t.disabled,i=t.excluded,r=e.isInitialized,s=n.target;return!(!r||o||!s||Me(s,i))}(n,e);s&&(function(e,n){var t=Ve(n);e.pinchStartDistance=t,e.lastDistance=t,e.pinchStartScale=e.transformState.scale,e.isPanning=!1,A(e)}(n,e),A(n),L(Se(n),e,i),L(Se(n),e,r))}},this.onPinch=function(e){var t=n.setup.disabled,o=n.props,i=o.onPinching,r=o.onZoom;if(!t){var s=function(e){var n=e.setup.pinch.disabled,t=e.isInitialized,o=e.pinchStartDistance;return!(!t||n||!o)}(n);s&&(e.preventDefault(),e.stopPropagation(),Oe(n,e),L(Se(n),e,i),L(Se(n),e,r))}},this.onPinchStop=function(e){var t,o,i=n.props,r=i.onPinchingStop,s=i.onZoomStop;n.pinchStartScale&&(o=(t=n).pinchMidpoint,t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,re(t,null==o?void 0:o.x,null==o?void 0:o.y),L(Se(n),e,r),L(Se(n),e,s))},this.onTouchPanningStart=function(e){var t=n.setup.disabled,o=n.props.onPanningStart;if(!t&&Z(n,e))if(n.lastTouch&&+new Date-n.lastTouch<200&&1===e.touches.length)n.onDoubleClick(e);else{n.lastTouch=+new Date,A(n);var i=e.touches,r=1===i.length,s=2===i.length;r&&(A(n),ee(n,e),L(Se(n),e,o)),s&&n.onPinchStart(e)}},this.onTouchPanning=function(e){var t=n.setup.disabled,o=n.props.onPanning;if(n.isPanning&&1===e.touches.length){if(t)return;if(!K(n))return;e.preventDefault(),e.stopPropagation();var i=e.touches[0];te(n,i.clientX,i.clientY),L(Se(n),e,o)}else e.touches.length>1&&n.onPinch(e)},this.onTouchPanningStop=function(e){n.onPanningStop(e),n.onPinchStop(e)},this.onDoubleClick=function(e){if(!n.setup.disabled){var t=function(e,n){var t=e.isInitialized,o=e.setup,i=e.wrapperComponent,r=o.doubleClick,s=r.disabled,a=r.excluded,l=n.target,c=null==i?void 0:i.contains(l);return!(!(t&&l&&c)||s||Me(l,a))}(n,e);t&&Ie(n,e)}},this.clearPanning=function(e){n.isPanning&&n.onPanningStop(e)},this.setKeyPressed=function(e){n.pressedKeys[e.key]=!0},this.setKeyUnPressed=function(e){n.pressedKeys[e.key]=!1},this.isPressingKeys=function(e){return!e.length||Boolean(e.find((function(e){return n.pressedKeys[e]})))},this.setTransformState=function(e,t,o){var i=n.props.onTransformed;if(Number.isNaN(e)||Number.isNaN(t)||Number.isNaN(o))console.error("Detected NaN set state values");else{e!==n.transformState.scale&&(n.transformState.previousScale=n.transformState.scale,n.transformState.scale=e),n.transformState.positionX=t,n.transformState.positionY=o;var r=Se(n);n.onChangeCallbacks.forEach((function(e){return e(r)})),L(r,{scale:e,positionX:t,positionY:o},i),n.applyTransformation()}},this.setCenter=function(){if(n.wrapperComponent&&n.contentComponent){var e=Te(n.transformState.scale,n.wrapperComponent,n.contentComponent);n.setTransformState(e.scale,e.positionX,e.positionY)}},this.handleTransformStyles=function(e,t,o){return n.props.customTransform?n.props.customTransform(e,t,o):function(e,n,t){return"translate(".concat(e,"px, ").concat(n,"px) scale(").concat(t,")")}(e,t,o)},this.applyTransformation=function(){if(n.mounted&&n.contentComponent){var e=n.transformState,t=e.scale,o=e.positionX,i=e.positionY,r=n.handleTransformStyles(o,i,t);n.contentComponent.style.transform=r}},this.getContext=function(){return Se(n)},this.onChange=function(e){return n.onChangeCallbacks.has(e)||n.onChangeCallbacks.add(e),function(){n.onChangeCallbacks.delete(e)}},this.init=function(e,t){n.cleanupWindowEvents(),n.wrapperComponent=e,n.contentComponent=t,$(n,n.transformState.scale),n.handleInitializeWrapperEvents(e),n.handleInitialize(t),n.initializeWindowEvents(),n.isInitialized=!0,L(Se(n),void 0,n.props.onInit)},this.props=e,this.setup=fe(this.props),this.transformState=pe(this.props)},Ye=e.createContext(null),ze=e.forwardRef((function(t,o){var r=n(0)[1],s=t.children,u=a(new Le(t)).current,d=function(e,n){return"function"==typeof e?e(n):e}(t.children,Se(u)),p=l((function(){"function"==typeof s&&r((function(e){return e+1}))}),[s]);return c(o,(function(){return Se(u)}),[u]),i((function(){u.update(t)}),[u,t]),i((function(){return u.onChange(p)}),[u,t,p]),e.createElement(Ye.Provider,{value:u},d)}));var Ae="transform-component-module_wrapper__7HFJe",je="transform-component-module_content__uCDPE";!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===t&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".transform-component-module_wrapper__7HFJe {\n  position: relative;\n  width: -moz-fit-content;\n  width: fit-content;\n  height: -moz-fit-content;\n  height: fit-content;\n  overflow: hidden;\n  -webkit-touch-callout: none; /* iOS Safari */\n  -webkit-user-select: none; /* Safari */\n  -khtml-user-select: none; /* Konqueror HTML */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* Internet Explorer/Edge */\n  user-select: none;\n  margin: 0;\n  padding: 0;\n}\n.transform-component-module_content__uCDPE {\n  display: flex;\n  flex-wrap: wrap;\n  width: -moz-fit-content;\n  width: fit-content;\n  height: -moz-fit-content;\n  height: fit-content;\n  margin: 0;\n  padding: 0;\n  transform-origin: 0% 0%;\n}\n.transform-component-module_content__uCDPE img {\n  pointer-events: none;\n}\n");var Xe=function(n){var t=n.children,r=n.wrapperClass,s=void 0===r?"":r,l=n.contentClass,c=void 0===l?"":l,u=n.wrapperStyle,d=n.contentStyle,p=n.wrapperProps,f=void 0===p?{}:p,m=n.contentProps,y=void 0===m?{}:m,v=o(Ye).init,h=a(null),g=a(null);return i((function(){var e=h.current,n=g.current;null!==e&&null!==n&&v&&v(e,n)}),[]),e.createElement("div",se({},f,{ref:h,className:"react-transform-wrapper ".concat(Ae," ").concat(s),style:u}),e.createElement("div",se({},y,{ref:g,className:"react-transform-component ".concat(je," ").concat(c),style:d}),t))};e.forwardRef((function(n,t){var r,s=a(null),l=o(Ye);return i((function(){return l.onChange((function(e){if(s.current){s.current.style.transform=l.handleTransformStyles(0,0,1/e.state.scale)}}))}),[l]),e.createElement("div",se({},n,{ref:(r=[s,t],function(e){r.forEach((function(n){"function"==typeof n?n(e):null!=n&&(n.current=e)}))})}))}));var We={container:"ConnectorCurve-module_container__pqaPv",path:"ConnectorCurve-module_path__CjFPJ",pathTmp:"ConnectorCurve-module_pathTmp__g4cyl",waypoint:"ConnectorCurve-module_waypoint__YhVmn",selected:"ConnectorCurve-module_selected__9zOuy",invalid:"ConnectorCurve-module_invalid__ar5Fy",destroy:"ConnectorCurve-module_destroy__qyMSc"};function Re({type:n,src:t,dst:o,scale:i,tmp:r,invalid:s,onContextMenu:a,waypoints:l=[],onWaypointContextMenu:c,onUpdateWaypoint:p,onWaypointMouseDown:f,isWaypointSelected:m}){var y,v,h;const{currentTheme:x}=T(),{scale:b}=g(),[w,C]=e.useState(!1),[S,P]=e.useState(-1),[M,N]=e.useState(!1);if(!t||!o)return;const H={x:t.x<o.x?5:5-(o.x-t.x),y:t.y<o.y?5:5-(o.y-t.y)},V={x:t.x<o.x?o.x-t.x+5:5,y:t.y<o.y?o.y-t.y+5:5},_=50;let E=Math.min(t.x,o.x),O=Math.min(t.y,o.y),k=Math.max(t.x,o.x),I=Math.max(t.y,o.y);const L=l.map((e=>({...e,originalX:e.x,originalY:e.y,x:e.x-E,y:e.y-O}))),Y=V.x>H.x?Math.abs(V.x-H.x)/2:H.x-V.x<150?H.x+(H.x-V.x):H.x+150+(H.x-V.x)/7,z=H.y,A=V.x>H.x?Math.abs(V.x-H.x)/2:H.x-V.x<150?V.x+(V.x-H.x):V.x-150-(H.x-V.x)/7,j=V.y;let X=`M ${H.x+_} ${H.y+_}`;if(0===l.length)X+=` C ${Y+_} ${z+_}, ${A+_} ${j+_}, ${V.x+_} ${V.y+_}`;else{const e=[{x:H.x,y:H.y},...L,{x:V.x,y:V.y}];for(let n=0;n<e.length-1;n++){const t=e[n],o=e[n+1],i={x:t.x+(o.x-t.x)/2,y:t.y},r={x:t.x+(o.x-t.x)/2,y:o.y};X+=` C ${i.x+_} ${i.y+_}, ${r.x+_} ${r.y+_}, ${o.x+_} ${o.y+_}`}}return d("svg",{style:{transform:`translate(${E-_}px, ${O-_}px)`,width:k-E+100,height:I-O+100,zIndex:r?1e3:-1,overflow:"visible"},className:[We.container,s?We.invalid:null].join(" "),children:[u("path",{style:{stroke:null!==(y=null!==(v=null!==(h=x.connections?.[n?.type]?.color)&&void 0!==h?h:n?.color)&&void 0!==v?v:x.connections?.default?.color)&&void 0!==y?y:"#ccc",strokeWidth:w?Math.max(10,10*i):Math.max(4,5*i)},className:[We.path,r?We.pathTmp:null].filter(Boolean).join(" "),d:X,onContextMenu:a,onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)}),L.map(((e,t)=>{var o,r,s,a,d,y;const v=m&&m(t),h=S===t||M&&S===t||v?Math.max(10,10*i):Math.max(6,6*i);return u("circle",{cx:e.x+_,cy:e.y+_,r:h,stroke:null!==(o=null!==(r=null!==(s=x.connections?.[n?.type]?.color)&&void 0!==s?s:n?.color)&&void 0!==r?r:x.connections?.default?.color)&&void 0!==o?o:"#ccc",fill:null!==(a=null!==(d=null!==(y=x.connections?.[n?.type]?.color)&&void 0!==y?y:n?.color)&&void 0!==d?d:x.connections?.default?.color)&&void 0!==a?a:"#ccc",strokeWidth:v?Math.max(3,3*i):Math.max(2,2*i),style:{cursor:M&&S===t?"grabbing":"grab"},onMouseEnter:()=>P(t),onMouseLeave:()=>P(-1),onMouseDown:e=>{if(f&&f(e,t),M)return;e.preventDefault(),e.stopPropagation(),N(!0);const n=e.clientX,o=e.clientY,i=l[t],r=e=>{e.preventDefault();const r=(e.clientX-n)/b,s=(e.clientY-o)/b,a={x:i.x+r,y:i.y+s};p&&p(t,a)},s=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s),N(!1),P(-1)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)},onContextMenu:e=>c&&c(e,t),className:[We.waypoint,v?We.selected:null].join(" ")},`waypoint-${t}`)}))]})}function $e({type:e,src:n,dst:t,scale:o,tmp:i,onContextMenu:r,index:s,n1Box:a,n2Box:l,waypoints:c=[],onWaypointContextMenu:d,onUpdateWaypoint:p,onWaypointMouseDown:f,isWaypointSelected:m}){return n&&t?u(Re,{type:e,src:n,dst:t,scale:o,tmp:i,onContextMenu:r,waypoints:c,onWaypointContextMenu:d,onUpdateWaypoint:p,onWaypointMouseDown:f,isWaypointSelected:m}):null}var Be="ContextMenu-module_container__kpcIH",De="ContextMenu-module_contextMenu__xllaM",Fe="ContextMenu-module_contextMenuItemContainer__T7rR2",Ze="ContextMenu-module_contextMenuItemLabelContainer__fkrNo",Ke="ContextMenu-module_contextMenuItemLabel__IJE3x",qe="ContextMenu-module_contextMenuItemDescription__wVBWj",Je="ContextMenu-module_contextMenuItemSubMenu__n6J-S",Ue="ContextMenu-module_submenu__7UZMP",Qe="ContextMenu-module_searchInput__eQZ-H";function Ge(e,n,t={},o=""){if(!e||!n)return o;const i=e[n]?.replace(/\{(\w+)\}/gim,((e,n)=>t[n]||n));return i||o}const en=({isFiltered:e,options:t,onSelectOption:o,style:i})=>{const[r,s]=n(null),[a,l]=n(null),[c,p]=n("left"),[f,m]=n("top"),y=t?.find((e=>e.label===r));return t?.length?d("ul",{className:De,style:i,children:[t?.filter(e)?.sort(((e,n)=>e.label.localeCompare(n.label)))?.map(((n,t)=>!0===n.separator?u("li",{children:u("hr",{})},`${n.id}-${t}`):d("li",{onClick:e=>o(n,e),onMouseEnter:e=>((e,n)=>{s(n);const t=e.currentTarget.getBoundingClientRect().top-e.currentTarget.parentNode.getBoundingClientRect().top;l(t);const o=window.innerWidth,i=e.target.getBoundingClientRect().width,r=window.innerHeight,a=e.target.getBoundingClientRect().height,c=e.currentTarget.getBoundingClientRect().right;p(c+i>o?"right":"left");const u=e.currentTarget.getBoundingClientRect().bottom;m(u+a>r?"bottom":"top")})(e,n.label),onMouseLeave:()=>{s(null)},children:[d("div",{className:Fe,children:[u("div",{className:Ze,children:u("div",{className:Ke,style:n.style,children:n.label})}),n.children&&u("div",{className:Je,children:"▶"})]}),n.children&&n.label===r&&u(en,{isFiltered:e,options:n.children.map((e=>({...e,_parent:n}))),onSelectOption:o,className:Ue,style:{[c]:"100%",top:"top"===f?a:null,bottom:"bottom"===f?0:null}})]},`${n.label}-${t}`))),y?.description&&u("li",{children:u("div",{className:qe,children:u("pre",{children:y.description})})})]}):null},nn=({containerRef:e,i18n:t,children:o})=>{T();const[r,s]=n({x:0,y:0}),[l,c]=n(null),[f,m]=n(""),y=a(null),v=a(null),h=e=>{y.current&&!y.current.contains(e.target)&&(m(""),c(null))};i((()=>(document.addEventListener("click",h),document.addEventListener("mousedown",h),()=>{document.removeEventListener("click",h),document.removeEventListener("mousedown",h)})),[]);const g=e=>{var n,t;if(!f?.length)return!0;const o=f.toLocaleLowerCase();return(null!==(n=e.label?.toLowerCase()?.indexOf(o))&&void 0!==n?n:-1)>-1||((null!==(t=e.description?.toLowerCase()?.indexOf(o))&&void 0!==t?t:-1)>-1||!(!e.children?.length||!e.children?.some((e=>g(e)))))},x=l?.filter((e=>Boolean(e)));return d(p,{children:[o({handleContextMenu:(n,t)=>{var o;n.preventDefault(),n.stopPropagation(),setTimeout((()=>v.current?.focus()),0);const i=null!==(o=e.current?.getBoundingClientRect())&&void 0!==o?o:{left:0,top:0},r=n.clientX-i.left,a=n.clientY-i.top;c(t),s({x:r,y:a})}}),x?.length?d("div",{ref:y,className:Be,style:{left:r.x,top:r.y,visibility:x?"visible":"hidden"},children:[u("input",{ref:v,type:"text",className:Qe,placeholder:Ge(t,"contextMenu.search",{},"Search"),autoFocus:!0,value:null!=f?f:"",onChange:e=>m(e.target.value)}),u(en,{isFiltered:g,options:x,onSelectOption:(e,n)=>{n&&n.stopPropagation(),e.onClick?.(e),m(""),c(null)},style:{position:"relative"}})]}):null]})};var tn={container:"Screen-module_container__zkIN3",panel:"Screen-module_panel__P8WaY",controlsPanelVertical:"Screen-module_controlsPanelVertical__-1YKq",controlsPanelHorizontal:"Screen-module_controlsPanelHorizontal__LSyOH",statusPanel:"Screen-module_statusPanel__9lLEm",controlButton:"Screen-module_controlButton__mTn3T"},on={container:"Comment-module_container__ljhnb",selected:"Comment-module_selected__a-fQY",handler:"Comment-module_handler__nJR-3",moveHandler:"Comment-module_moveHandler__-IkO1",title:"Comment-module_title__5dw34",value:"Comment-module_value__A69Js"};const rn=({title:e,onChangeTitle:n,text:t,onChangeText:o,backgroundColor:r,position:s,size:c,onResize:p,onMove:f,onMoveEnd:m,isSelected:y,nodeId:v,onContextMenu:h})=>{var x,b,w,C;const{scale:S}=g(),P=a(null),M=l((e=>{e.stopPropagation();const n=e.pageX,t=e.pageY,o=e=>{const o=e.pageX-n,i=e.pageY-t;f?.({x:s.x+o/S,y:s.y+i/S})},i=e=>{const r=e.pageX-n,a=e.pageY-t;m?.({x:s.x+r/S,y:s.y+a/S}),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",i)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",i)}),[s,f,m,S]);return i((()=>{const e=P.current,n=n=>{c?.w===e.offsetWidth&&c?.h===e.offsetHeight||p?.({w:e.offsetWidth,h:e.offsetHeight})};return e.addEventListener("mouseup",n),()=>{e.removeEventListener("mouseup",n)}}),[]),d("div",{ref:P,id:`card-${v}`,className:[on.container,y?on.selected:""].join(" "),style:{backgroundColor:r,transform:`translate(${null!==(x=s?.x)&&void 0!==x?x:0}px, ${null!==(b=s?.y)&&void 0!==b?b:0}px)`,width:null!==(w=c?.w)&&void 0!==w?w:300,height:null!==(C=c?.h)&&void 0!==C?C:200},onClick:e=>{e.stopPropagation()},onMouseDown:e=>{e.target.closest("input")||e.target.closest("textarea")||e.stopPropagation()},onContextMenu:h,children:[u("div",{className:on.moveHandler,onMouseDown:M}),u("div",{className:on.handler}),u("input",{className:on.title,placeholder:"Comment",value:null!=e?e:"",onChange:e=>n(e.target.value),onMouseDown:e=>e.stopPropagation()}),u("textarea",{className:on.value,value:null!=t?t:"",onChange:e=>o(e.target.value),onMouseDown:e=>e.stopPropagation()})]},`card-${v}`)};let sn=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,n)=>e+=(n&=63)<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():n>62?"-":"_"),"");function an(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ln,cn,un,dn,pn,fn,mn,yn,vn,hn,gn,xn,bn,wn={exports:{}},Cn={exports:{}},Sn={};function Pn(){return cn||(cn=1,Cn.exports=(ln||(ln=1,function(){var e="function"==typeof Symbol&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,r=e?Symbol.for("react.profiler"):60114,s=e?Symbol.for("react.provider"):60109,a=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,p=e?Symbol.for("react.suspense_list"):60120,f=e?Symbol.for("react.memo"):60115,m=e?Symbol.for("react.lazy"):60116,y=e?Symbol.for("react.block"):60121,v=e?Symbol.for("react.fundamental"):60117,h=e?Symbol.for("react.responder"):60118,g=e?Symbol.for("react.scope"):60119;function x(e){if("object"==typeof e&&null!==e){var p=e.$$typeof;switch(p){case n:var y=e.type;switch(y){case l:case c:case o:case r:case i:case d:return y;default:var v=y&&y.$$typeof;switch(v){case a:case u:case m:case f:case s:return v;default:return p}}case t:return p}}}var b=l,w=c,C=a,S=s,P=n,M=u,N=o,T=m,H=f,V=t,_=r,E=i,O=d,k=!1;function I(e){return x(e)===c}Sn.AsyncMode=b,Sn.ConcurrentMode=w,Sn.ContextConsumer=C,Sn.ContextProvider=S,Sn.Element=P,Sn.ForwardRef=M,Sn.Fragment=N,Sn.Lazy=T,Sn.Memo=H,Sn.Portal=V,Sn.Profiler=_,Sn.StrictMode=E,Sn.Suspense=O,Sn.isAsyncMode=function(e){return k||(k=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),I(e)||x(e)===l},Sn.isConcurrentMode=I,Sn.isContextConsumer=function(e){return x(e)===a},Sn.isContextProvider=function(e){return x(e)===s},Sn.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},Sn.isForwardRef=function(e){return x(e)===u},Sn.isFragment=function(e){return x(e)===o},Sn.isLazy=function(e){return x(e)===m},Sn.isMemo=function(e){return x(e)===f},Sn.isPortal=function(e){return x(e)===t},Sn.isProfiler=function(e){return x(e)===r},Sn.isStrictMode=function(e){return x(e)===i},Sn.isSuspense=function(e){return x(e)===d},Sn.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===c||e===r||e===i||e===d||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===f||e.$$typeof===s||e.$$typeof===a||e.$$typeof===u||e.$$typeof===v||e.$$typeof===h||e.$$typeof===g||e.$$typeof===y)},Sn.typeOf=x}()),Sn)),Cn.exports}
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/function Mn(){if(dn)return un;dn=1;var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;return un=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var n={},t=0;t<10;t++)n["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(n).map((function(e){return n[e]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(e){o[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}()?Object.assign:function(o,i){for(var r,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(o),l=1;l<arguments.length;l++){for(var c in r=Object(arguments[l]))n.call(r,c)&&(a[c]=r[c]);if(e){s=e(r);for(var u=0;u<s.length;u++)t.call(r,s[u])&&(a[s[u]]=r[s[u]])}}return a},un}function Nn(){if(fn)return pn;fn=1;return pn="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}function Tn(){return yn?mn:(yn=1,mn=Function.call.bind(Object.prototype.hasOwnProperty))}function Hn(){if(xn)return gn;xn=1;var e,n=Pn(),t=Mn(),o=Nn(),i=Tn(),r=function(){if(hn)return vn;hn=1;var e,n=Nn(),t={},o=Tn();function i(i,r,s,a,l){for(var c in i)if(o(i,c)){var u;try{if("function"!=typeof i[c]){var d=Error((a||"React class")+": "+s+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof i[c]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw d.name="Invariant Violation",d}u=i[c](r,c,a,s,null,n)}catch(e){u=e}if(!u||u instanceof Error||e((a||"React class")+": type specification of "+s+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof u+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),u instanceof Error&&!(u.message in t)){t[u.message]=!0;var p=l?l():"";e("Failed "+s+" type: "+u.message+(null!=p?p:""))}}}return e=function(e){var n="Warning: "+e;"undefined"!=typeof console&&console.error(n);try{throw new Error(n)}catch(e){}},i.resetWarningCache=function(){t={}},vn=i}();function s(){return null}return e=function(e){var n="Warning: "+e;"undefined"!=typeof console&&console.error(n);try{throw new Error(n)}catch(e){}},gn=function(a,l){var c="function"==typeof Symbol&&Symbol.iterator,u="@@iterator";var d="<<anonymous>>",p={array:v("array"),bigint:v("bigint"),bool:v("boolean"),func:v("function"),number:v("number"),object:v("object"),string:v("string"),symbol:v("symbol"),any:y(s),arrayOf:function(e){return y((function(n,t,i,r,s){if("function"!=typeof e)return new m("Property `"+s+"` of component `"+i+"` has invalid PropType notation inside arrayOf.");var a=n[t];if(!Array.isArray(a))return new m("Invalid "+r+" `"+s+"` of type `"+x(a)+"` supplied to `"+i+"`, expected an array.");for(var l=0;l<a.length;l++){var c=e(a,l,i,r,s+"["+l+"]",o);if(c instanceof Error)return c}return null}))},element:y((function(e,n,t,o,i){var r=e[n];return a(r)?null:new m("Invalid "+o+" `"+i+"` of type `"+x(r)+"` supplied to `"+t+"`, expected a single ReactElement.")})),elementType:y((function(e,t,o,i,r){var s=e[t];return n.isValidElementType(s)?null:new m("Invalid "+i+" `"+r+"` of type `"+x(s)+"` supplied to `"+o+"`, expected a single ReactElement type.")})),instanceOf:function(e){return y((function(n,t,o,i,r){if(!(n[t]instanceof e)){var s=e.name||d;return new m("Invalid "+i+" `"+r+"` of type `"+(((a=n[t]).constructor&&a.constructor.name?a.constructor.name:d)+"` supplied to `")+o+"`, expected instance of `"+s+"`.")}var a;return null}))},node:y((function(e,n,t,o,i){return g(e[n])?null:new m("Invalid "+o+" `"+i+"` supplied to `"+t+"`, expected a ReactNode.")})),objectOf:function(e){return y((function(n,t,r,s,a){if("function"!=typeof e)return new m("Property `"+a+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var l=n[t],c=x(l);if("object"!==c)return new m("Invalid "+s+" `"+a+"` of type `"+c+"` supplied to `"+r+"`, expected an object.");for(var u in l)if(i(l,u)){var d=e(l,u,r,s,a+"."+u,o);if(d instanceof Error)return d}return null}))},oneOf:function(n){if(!Array.isArray(n))return e(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),s;return y((function(e,t,o,i,r){for(var s=e[t],a=0;a<n.length;a++)if(f(s,n[a]))return null;var l=JSON.stringify(n,(function(e,n){return"symbol"===b(n)?String(n):n}));return new m("Invalid "+i+" `"+r+"` of value `"+String(s)+"` supplied to `"+o+"`, expected one of "+l+".")}))},oneOfType:function(n){if(!Array.isArray(n))return e("Invalid argument supplied to oneOfType, expected an instance of array."),s;for(var t=0;t<n.length;t++){var r=n[t];if("function"!=typeof r)return e("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+w(r)+" at index "+t+"."),s}return y((function(e,t,r,s,a){for(var l=[],c=0;c<n.length;c++){var u=(0,n[c])(e,t,r,s,a,o);if(null==u)return null;u.data&&i(u.data,"expectedType")&&l.push(u.data.expectedType)}return new m("Invalid "+s+" `"+a+"` supplied to `"+r+"`"+(l.length>0?", expected one of type ["+l.join(", ")+"]":"")+".")}))},shape:function(e){return y((function(n,t,i,r,s){var a=n[t],l=x(a);if("object"!==l)return new m("Invalid "+r+" `"+s+"` of type `"+l+"` supplied to `"+i+"`, expected `object`.");for(var c in e){var u=e[c];if("function"!=typeof u)return h(i,r,s,c,b(u));var d=u(a,c,i,r,s+"."+c,o);if(d)return d}return null}))},exact:function(e){return y((function(n,r,s,a,l){var c=n[r],u=x(c);if("object"!==u)return new m("Invalid "+a+" `"+l+"` of type `"+u+"` supplied to `"+s+"`, expected `object`.");var d=t({},n[r],e);for(var p in d){var f=e[p];if(i(e,p)&&"function"!=typeof f)return h(s,a,l,p,b(f));if(!f)return new m("Invalid "+a+" `"+l+"` key `"+p+"` supplied to `"+s+"`.\nBad object: "+JSON.stringify(n[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var y=f(c,p,s,a,l+"."+p,o);if(y)return y}return null}))}};function f(e,n){return e===n?0!==e||1/e==1/n:e!=e&&n!=n}function m(e,n){this.message=e,this.data=n&&"object"==typeof n?n:{},this.stack=""}function y(n){var t={},i=0;function r(r,s,a,c,u,p,f){if(c=c||d,p=p||a,f!==o){if(l){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}if("undefined"!=typeof console){var v=c+":"+a;!t[v]&&i<3&&(e("You are manually calling a React.PropTypes validation function for the `"+p+"` prop on `"+c+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),t[v]=!0,i++)}}return null==s[a]?r?null===s[a]?new m("The "+u+" `"+p+"` is marked as required in `"+c+"`, but its value is `null`."):new m("The "+u+" `"+p+"` is marked as required in `"+c+"`, but its value is `undefined`."):null:n(s,a,c,u,p)}var s=r.bind(null,!1);return s.isRequired=r.bind(null,!0),s}function v(e){return y((function(n,t,o,i,r,s){var a=n[t];return x(a)!==e?new m("Invalid "+i+" `"+r+"` of type `"+b(a)+"` supplied to `"+o+"`, expected `"+e+"`.",{expectedType:e}):null}))}function h(e,n,t,o,i){return new m((e||"React class")+": "+n+" type `"+t+"."+o+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+i+"`.")}function g(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(g);if(null===e||a(e))return!0;var n=function(e){var n=e&&(c&&e[c]||e[u]);if("function"==typeof n)return n}(e);if(!n)return!1;var t,o=n.call(e);if(n!==e.entries){for(;!(t=o.next()).done;)if(!g(t.value))return!1}else for(;!(t=o.next()).done;){var i=t.value;if(i&&!g(i[1]))return!1}return!0;default:return!1}}function x(e){var n=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,n){return"symbol"===e||!!n&&("Symbol"===n["@@toStringTag"]||"function"==typeof Symbol&&n instanceof Symbol)}(n,e)?"symbol":n}function b(e){if(null==e)return""+e;var n=x(e);if("object"===n){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return n}function w(e){var n=b(e);switch(n){case"array":case"object":return"an "+n;case"boolean":case"date":case"regexp":return"a "+n;default:return n}}return m.prototype=Error.prototype,p.checkPropTypes=r,p.resetWarningCache=r.resetWarningCache,p.PropTypes=p,p},gn}var Vn=function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=2)}([function(e,n){e.exports=function(){if(bn)return wn.exports;bn=1;var e=Pn();return wn.exports=Hn()(e.isElement,!0),wn.exports}()},function(n,t){n.exports=e},function(e,n,t){t.r(n);var o=t(1),i=t(0),r=function(){return(r=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},s=0,a=o.forwardRef((function(e,n){var t=e.title,i=void 0===t?null:t,a=e.description,l=void 0===a?null:a,c=e.size,u=void 0===c?null:c,d=e.color,p=void 0===d?"currentColor":d,f=e.horizontal,m=void 0===f?null:f,y=e.vertical,v=void 0===y?null:y,h=e.rotate,g=void 0===h?null:h,x=e.spin,b=void 0===x?null:x,w=e.style,C=void 0===w?{}:w,S=e.children,P=function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)n.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(t[o[i]]=e[o[i]])}return t}(e,["title","description","size","color","horizontal","vertical","rotate","spin","style","children"]);s++;var M,N=null!==b&&b,T=o.Children.map(S,(function(e){var n=e;!0!==N&&(N=!0===(null===b?n.props.spin:b));var t=n.props.size;"number"==typeof u&&"number"==typeof n.props.size&&(t=n.props.size/u);var i={size:t,color:null===p?n.props.color:p,horizontal:null===m?n.props.horizontal:m,vertical:null===v?n.props.vertical:v,rotate:null===g?n.props.rotate:g,spin:null===b?n.props.spin:b,inStack:!0};return o.cloneElement(n,i)}));null!==u&&(C.width="string"==typeof u?u:1.5*u+"rem");var H,V="stack_labelledby_"+s,_="stack_describedby_"+s;if(i)M=l?V+" "+_:V;else if(H="presentation",l)throw new Error("title attribute required when description is set");return o.createElement("svg",r({ref:n,viewBox:"0 0 24 24",style:C,role:H,"aria-labelledby":M},P),i&&o.createElement("title",{id:V},i),l&&o.createElement("desc",{id:_},l),N&&o.createElement("style",null,"@keyframes spin { from { transform: rotate(0deg) } to { transform: rotate(360deg) } }","@keyframes spin-inverse { from { transform: rotate(0deg) } to { transform: rotate(-360deg) } }"),T)}));a.displayName="Stack",a.propTypes={size:i.oneOfType([i.number,i.string]),color:i.string,horizontal:i.bool,vertical:i.bool,rotate:i.number,spin:i.oneOfType([i.bool,i.number]),children:i.oneOfType([i.arrayOf(i.node),i.node]).isRequired,className:i.string,style:i.object},a.defaultProps={size:null,color:null,horizontal:null,vertical:null,rotate:null,spin:null};var l=a;t.d(n,"Icon",(function(){return d})),t.d(n,"Stack",(function(){return l}));var c=function(){return(c=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},u=0,d=o.forwardRef((function(e,n){var t=e.path,i=e.id,r=void 0===i?++u:i,s=e.title,a=void 0===s?null:s,l=e.description,d=void 0===l?null:l,p=e.size,f=void 0===p?null:p,m=e.color,y=void 0===m?"currentColor":m,v=e.horizontal,h=void 0!==v&&v,g=e.vertical,x=void 0!==g&&g,b=e.rotate,w=void 0===b?0:b,C=e.spin,S=void 0!==C&&C,P=e.style,M=void 0===P?{}:P,N=e.inStack,T=void 0!==N&&N,H=function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)n.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(t[o[i]]=e[o[i]])}return t}(e,["path","id","title","description","size","color","horizontal","vertical","rotate","spin","style","inStack"]),V={},_=[];null!==f&&(T?_.push("scale("+f+")"):(M.width="string"==typeof f?f:1.5*f+"rem",M.height=M.width)),h&&_.push("scaleX(-1)"),x&&_.push("scaleY(-1)"),0!==w&&_.push("rotate("+w+"deg)"),null!==y&&(V.fill=y);var E=o.createElement("path",c({d:t,style:V},T?H:{})),O=E;_.length>0&&(M.transform=_.join(" "),M.transformOrigin="center",T&&(O=o.createElement("g",{style:M},E,o.createElement("rect",{width:"24",height:"24",fill:"transparent"}))));var k,I=O,L=!0===S||"number"!=typeof S?2:S,Y=!T&&(h||x);if(L<0&&(Y=!Y),S&&(I=o.createElement("g",{style:{animation:"spin"+(Y?"-inverse":"")+" linear "+Math.abs(L)+"s infinite",transformOrigin:"center"}},O,!(h||x||0!==w)&&o.createElement("rect",{width:"24",height:"24",fill:"transparent"}))),T)return I;var z,A="icon_labelledby_"+r,j="icon_describedby_"+r;if(a)k=d?A+" "+j:A;else if(z="presentation",d)throw new Error("title attribute required when description is set");return o.createElement("svg",c({ref:n,viewBox:"0 0 24 24",style:M,role:z,"aria-labelledby":k},H),a&&o.createElement("title",{id:A},a),d&&o.createElement("desc",{id:j},d),!T&&S&&(Y?o.createElement("style",null,"@keyframes spin-inverse { from { transform: rotate(0deg) } to { transform: rotate(-360deg) } }"):o.createElement("style",null,"@keyframes spin { from { transform: rotate(0deg) } to { transform: rotate(360deg) } }")),I)}));d.displayName="Icon",d.propTypes={path:i.string.isRequired,size:i.oneOfType([i.number,i.string]),color:i.string,horizontal:i.bool,vertical:i.bool,rotate:i.number,spin:i.oneOfType([i.bool,i.number]),style:i.object,inStack:i.bool,className:i.string},d.defaultProps={size:null,color:"currentColor",horizontal:!1,vertical:!1,rotate:0,spin:!1},n.default=d}]),_n=an(Vn);const En=({children:e,...n})=>{const{currentTheme:t}=T();return u("button",{...n,style:{backgroundColor:t.buttons?.default?.backgroundColor,border:t.buttons?.default?.border,color:t.buttons?.default?.color,borderRadius:t.roundness},children:e})},On=({zoomIn:e,zoomOut:n,centerView:t,resetView:o,canMove:i,setCanMove:r,position:s,scale:a,setStateAndNotify:l})=>d("div",{className:[tn.panel,tn.controlsPanelVertical].join(" "),children:[u(En,{className:tn.controlButton,onClick:()=>e(),children:u(_n,{path:"M9,2A7,7 0 0,1 16,9C16,10.57 15.5,12 14.61,13.19L15.41,14H16L22,20L20,22L14,16V15.41L13.19,14.61C12,15.5 10.57,16 9,16A7,7 0 0,1 2,9A7,7 0 0,1 9,2M8,5V8H5V10H8V13H10V10H13V8H10V5H8Z",size:.6})}),u(En,{className:tn.controlButton,onClick:()=>n(),children:u(_n,{path:"M9,2A7,7 0 0,1 16,9C16,10.57 15.5,12 14.61,13.19L15.41,14H16L22,20L20,22L14,16V15.41L13.19,14.61C12,15.5 10.57,16 9,16A7,7 0 0,1 2,9A7,7 0 0,1 9,2M5,8V10H13V8H5Z",size:.6})}),u(En,{className:tn.controlButton,onClick:()=>{t(),l((e=>({...e,position:s,scale:a})))},children:u(_n,{path:"M9,5A7,7 0 0,0 2,12A7,7 0 0,0 9,19C10.04,19 11.06,18.76 12,18.32C12.94,18.76 13.96,19 15,19A7,7 0 0,0 22,12A7,7 0 0,0 15,5C13.96,5 12.94,5.24 12,5.68C11.06,5.24 10.04,5 9,5M9,7C9.34,7 9.67,7.03 10,7.1C8.72,8.41 8,10.17 8,12C8,13.83 8.72,15.59 10,16.89C9.67,16.96 9.34,17 9,17A5,5 0 0,1 4,12A5,5 0 0,1 9,7M15,7A5,5 0 0,1 20,12A5,5 0 0,1 15,17C14.66,17 14.33,16.97 14,16.9C15.28,15.59 16,13.83 16,12C16,10.17 15.28,8.41 14,7.11C14.33,7.04 14.66,7 15,7Z",size:.6})}),u(En,{className:tn.controlButton,onClick:()=>{o(),l((e=>({...e,position:s,scale:1})))},children:u(_n,{path:"M17 22V20H20V17H22V20.5C22 20.89 21.84 21.24 21.54 21.54C21.24 21.84 20.89 22 20.5 22H17M7 22H3.5C3.11 22 2.76 21.84 2.46 21.54C2.16 21.24 2 20.89 2 20.5V17H4V20H7V22M17 2H20.5C20.89 2 21.24 2.16 21.54 2.46C21.84 2.76 22 3.11 22 3.5V7H20V4H17V2M7 2V4H4V7H2V3.5C2 3.11 2.16 2.76 2.46 2.46C2.76 2.16 3.11 2 3.5 2H7M10.5 6C13 6 15 8 15 10.5C15 11.38 14.75 12.2 14.31 12.9L17.57 16.16L16.16 17.57L12.9 14.31C12.2 14.75 11.38 15 10.5 15C8 15 6 13 6 10.5C6 8 8 6 10.5 6M10.5 8C9.12 8 8 9.12 8 10.5C8 11.88 9.12 13 10.5 13C11.88 13 13 11.88 13 10.5C13 9.12 11.88 8 10.5 8Z",size:.6})}),u(En,{className:tn.controlButton,onClick:()=>r(!i),children:u(_n,{path:i?"M18 1C15.24 1 13 3.24 13 6V8H4C2.9 8 2 8.89 2 10V20C2 21.11 2.9 22 4 22H16C17.11 22 18 21.11 18 20V10C18 8.9 17.11 8 16 8H15V6C15 4.34 16.34 3 18 3C19.66 3 21 4.34 21 6V8H23V6C23 3.24 20.76 1 18 1M10 13C11.1 13 12 13.89 12 15C12 16.11 11.11 17 10 17C8.9 17 8 16.11 8 15C8 13.9 8.9 13 10 13Z":"M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z",size:.6})})]}),kn=({snapToGrid:e,handleSnapToGrid:n,viewMode:t})=>d("div",{className:[tn.panel,tn.controlsPanelHorizontal].join(" "),children:[u(En,{className:tn.controlButton,onClick:n,children:u(_n,{path:e?"M10,4V8H14V4H10M16,4V8H20V4H16M16,10V14H20V10H16M16,16V20H20V16H16M14,20V16H10V20H14M8,20V16H4V20H8M8,14V10H4V14H8M8,8V4H4V8H8M10,14H14V10H10V14M4,2H20A2,2 0 0,1 22,4V20A2,2 0 0,1 20,22H4C2.92,22 2,21.1 2,20V4A2,2 0 0,1 4,2Z":"M0,2.77L1.28,1.5L22.5,22.72L21.23,24L19.23,22H4C2.92,22 2,21.1 2,20V4.77L0,2.77M10,4V7.68L8,5.68V4H6.32L4.32,2H20A2,2 0 0,1 22,4V19.7L20,17.7V16H18.32L16.32,14H20V10H16V13.68L14,11.68V10H12.32L10.32,8H14V4H10M16,4V8H20V4H16M16,20H17.23L16,18.77V20M4,8H5.23L4,6.77V8M10,14H11.23L10,12.77V14M14,20V16.77L13.23,16H10V20H14M8,20V16H4V20H8M8,14V10.77L7.23,10H4V14H8Z",size:.6})}),d(En,{disabled:!0,className:tn.controlButton,children:["select"===t&&u(_n,{path:"M4,3H5V5H3V4A1,1 0 0,1 4,3M20,3A1,1 0 0,1 21,4V5H19V3H20M15,5V3H17V5H15M11,5V3H13V5H11M7,5V3H9V5H7M21,20A1,1 0 0,1 20,21H19V19H21V20M15,21V19H17V21H15M11,21V19H13V21H11M7,21V19H9V21H7M4,21A1,1 0 0,1 3,20V19H5V21H4M3,15H5V17H3V15M21,15V17H19V15H21M3,11H5V13H3V11M21,11V13H19V11H21M3,7H5V9H3V7M21,7V9H19V7H21Z",size:.6}),"select-add"===t&&u(_n,{path:"M13,17H17V13H19V17H23V19H19V23H17V19H13V17M11,17V19H9V17H11M7,17V19H5V17H7M19,9V11H17V9H19M19,5V7H17V5H19M15,5V7H13V5H15M11,5V7H9V5H11M7,5V7H5V5H7M7,13V15H5V13H7M7,9V11H5V9H7Z",size:.6}),"select-remove"===t&&u(_n,{path:"M21 20C21 20.55 20.55 21 20 21H19V19H21V20M15 21V19H17V21H15M11 21V19H13V21H11M7 21V19H9V21H7M4 21C3.45 21 3 20.55 3 20V19H5V21H4M3 15H5V17H3V15M21 15V17H19V15H21M14.59 8L12 10.59L9.41 8L8 9.41L10.59 12L8 14.59L9.41 16L12 13.41L14.59 16L16 14.59L13.41 12L16 9.41L14.59 8M3 11H5V13H3V11M21 11V13H19V11H21M3 7H5V9H3V7M21 7V9H19V7H21M4 3H5V5H3V4C3 3.45 3.45 3 4 3M20 3C20.55 3 21 3.45 21 4V5H19V3H20M15 5V3H17V5H15M11 5V3H13V5H11M7 5V3H9V5H7Z",size:.6}),"move"===t&&u(_n,{path:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z",size:.6})]})]}),In=({scale:e,position:n})=>d("div",{className:[tn.panel,tn.statusPanel].join(" "),children:[d("div",{children:["Scale: ",e]}),d("div",{children:["Position: ",JSON.stringify(n)]})]});var Ln="SelectionArea-module_container__td0Oq";const Yn=({localStartPoint:e,localEndPoint:n})=>(T(),e.x===n.x||e.y===n.y?null:u("div",{className:Ln,style:{transform:`translate(${Math.min(e.x,n.x)}px, ${Math.min(e.y,n.y)}px)`,width:Math.abs(n.x-e.x),height:Math.abs(n.y-e.y)}}));const zn={"contextMenu.search":"Search","contextMenu.add":"Add {nodeType}","contextMenu.removeThisNode":"Remove this node","contextMenu.removeSelectedNodes":"Remove selected nodes","contextMenu.cloneThisNode":"Clone this node","contextMenu.removeThisConnection":"Remove this connection","contextMenu.addWaypoint":"Add waypoint","contextMenu.removeWaypoint":"Remove waypoint"};function An({portTypes:e,nodeTypes:t,onChangeState:o,initialState:r,i18n:c=zn,debugMode:f}){var m,v,h,b,w;const C={label:Ge(c,"contextMenu.comment.label",{},"Comment"),type:"comment",inputs:()=>[],outputs:()=>[]};t&&(t.comment=C);const{currentTheme:S}=T(),P={"--port-size":"20px","--color-primary":S.colors?.primary,"--color-secondary":S.colors?.secondary,"--color-bg":S.colors?.background,"--color-text":S.colors?.text,"--color-hover":S.colors?.hover,"--color-selection-border":S.colors?.selectionBorder,"--roundness":S.roundness},{dragInfo:M}=y(),{position:N,setPosition:H,scale:V,setScale:_}=g(),[O,I]=n({x:0,y:0}),[L,Y]=n({x:0,y:0}),[z,A]=n(!1),[j,X]=n(!1),[W,R]=n(r),[$,B]=n(!1),[D,F]=n("select"),{selectedNodes:Z,setSelectedNodes:K,selectedWaypoints:q,setSelectedWaypoints:J,selectStartPoint:U,setSelectStartPoint:Q,selectEndPoint:G,setSelectEndPoint:ee,clearSelection:ne,selectAllNodes:te,addNodesToSelection:oe,removeNodesFromSelection:ie,addWaypointToSelection:re,removeWaypointFromSelection:se,isWaypointSelected:ae,processAreaSelection:le}=function({state:e}){const[t,o]=n([]),[i,r]=n([]),[s,a]=n({x:0,y:0}),[c,u]=n({x:0,y:0}),d=l((()=>{o([]),r([])}),[]),p=l((()=>{e?.nodes&&o(Object.keys(e.nodes))}),[e?.nodes]),f=l((e=>{o((n=>{const t=e.filter((e=>!n.includes(e)));return[...n,...t]}))}),[]),m=l((e=>{o((n=>n.filter((n=>!e.includes(n)))))}),[]),y=l((e=>{r((n=>n.some((n=>n.srcNode===e.srcNode&&n.srcPort===e.srcPort&&n.dstNode===e.dstNode&&n.dstPort===e.dstPort&&n.waypointIndex===e.waypointIndex))?n:[...n,e]))}),[]),v=l((e=>{r((n=>n.filter((n=>!(n.srcNode===e.srcNode&&n.srcPort===e.srcPort&&n.dstNode===e.dstNode&&n.dstPort===e.dstPort&&n.waypointIndex===e.waypointIndex)))))}),[]),h=l((e=>!!(e&&"object"==typeof e&&e.srcNode&&e.dstNode&&e.srcPort&&e.dstPort&&void 0!==e.waypointIndex)&&i.some((n=>n.srcNode===e.srcNode&&n.srcPort===e.srcPort&&n.dstNode===e.dstNode&&n.dstPort===e.dstPort&&n.waypointIndex===e.waypointIndex))),[i]),g=l((e=>{o((n=>{const t=e.filter((e=>!n.includes(e)));return[...n,...t]}))}),[]),x=l((e=>{o((n=>n.filter((n=>!e.includes(n)))))}),[]),b=l(((e,n,t,i=[])=>{e&&(t?.length>0||i?.length>0?"select"===n?(o(t||[]),r(i||[])):"select-add"===n?(t?.length>0&&f(t),i?.length>0&&i.forEach((e=>y(e)))):"select-remove"===n&&(t?.length>0&&m(t),i?.length>0&&i.forEach((e=>v(e)))):"select"===n&&d())}),[f,m,y,v,g,x,d]);return{selectedNodes:t,setSelectedNodes:o,selectedWaypoints:i,setSelectedWaypoints:r,selectStartPoint:s,setSelectStartPoint:a,selectEndPoint:c,setSelectEndPoint:u,clearSelection:d,selectAllNodes:p,addNodesToSelection:f,removeNodesFromSelection:m,addWaypointToSelection:y,removeWaypointFromSelection:v,addCommentsToSelection:g,removeCommentsFromSelection:x,isWaypointSelected:h,processAreaSelection:b}}({state:W});n({x:0,y:0});const ce=l(((e,n=200,t)=>(...o)=>clearTimeout(t,t=setTimeout((()=>e(...o)),n))),[]);i((()=>{r&&(r.scale&&_(r.scale),r.position&&H(r.position))}),[r,_,H]);const ue=l((e=>{R((n=>{const t=e(n);return B(!0),t}))}),[R]),de=a(),pe=de.current?.getBoundingClientRect(),fe=a(),{addNode:me,removeNodes:ye,cloneNode:ve,removeConnectionFromOutput:he,addWaypoint:ge,updateWaypointPosition:xe,removeWaypoint:be,connectNodes:we,updateNodeValues:Ce}=function({state:e,setStateAndNotify:n,setSelectedNodes:t,nodeTypes:o}){return{addNode:l(((e,t)=>{const o={id:sn(),name:e.label,type:e.type,position:t,values:e.inputs().reduce(((e,n)=>(null==n.defaultValue||(e[n.name]=n.defaultValue),e)),{})};n((e=>{var n;return{...e,nodes:{...null!==(n=e.nodes)&&void 0!==n?n:{},[o.id]:o}}}))}),[n]),removeNodes:l((i=>{if(!i?.length)return;const r=i.filter((n=>!o[e.nodes[n]?.type]?.root)),s=[...i],a={};for(const n of i){const t=e.nodes[n];if(t){if(t.connections?.outputs?.length)for(const n of t.connections.outputs){var l,c;const o=e.nodes[n.node];var u,d;if(o&&!r.includes(o.id))s.includes(o.id)||s.push(o.id),a[o.id]||(a[o.id]={...o,connections:{...o.connections,inputs:null!==(u=o.connections?.inputs)&&void 0!==u?u:[],outputs:null!==(d=o.connections?.outputs)&&void 0!==d?d:[]}}),a[o.id].connections.outputs=[...null!==(l=o.connections.outputs)&&void 0!==l?l:[]],a[o.id].connections.inputs=null!==(c=o.connections?.inputs?.filter((e=>!(e.port===n.name&&e.node===t.id))))&&void 0!==c?c:[]}if(t.connections?.inputs?.length)for(const n of t.connections.inputs){var p,f;const o=e.nodes[n.node];o&&!r.includes(o.id)&&(s.includes(o.id)||s.push(o.id),a[o.id]||(a[o.id]={...o}),a[o.id].connections.outputs=null!==(p=o.connections?.outputs?.filter((e=>!(e.port===n.name&&e.node===t.id))))&&void 0!==p?p:[],a[o.id].connections.inputs=[...null!==(f=o.connections.inputs)&&void 0!==f?f:[]])}}}t([]),n((n=>{var t;const i={...null!==(t=n.nodes)&&void 0!==t?t:{}};return s.filter((n=>!o[e.nodes[n]?.type]?.root)).forEach((e=>{delete i[e]})),Object.values(a).forEach((e=>{i[e.id]=e})),{...n,nodes:i}}))}),[e,n,t,o]),cloneNode:l((t=>{const o=e.nodes[t];if(!o)return;const i={...o,id:sn(),position:{x:o.position.x+20,y:o.position.y+20},connections:{inputs:[],outputs:[]}};n((e=>{var n;return{...e,nodes:{...null!==(n=e.nodes)&&void 0!==n?n:{},[i.id]:i}}}))}),[n,e]),removeConnectionFromOutput:l(((e,t,o,i)=>{n((n=>{var r;const s={...null!==(r=n.nodes)&&void 0!==r?r:{}};return s[e]&&s[o]?(s[e]={...s[e],connections:{...s[e].connections,outputs:s[e].connections.outputs.filter((e=>!(e.name===t&&e.node===o&&e.port===i)))}},s[o]={...s[o],connections:{...s[o].connections,inputs:s[o].connections.inputs.filter((n=>!(n.name===i&&n.node===e&&n.port===t)))}},{...n,nodes:s}):n}))}),[n]),addWaypoint:l(((e,t,o,i,r)=>{n((n=>{var s;const a={...null!==(s=n.nodes)&&void 0!==s?s:{}};if(!a[e])return n;const l=a[e].connections?.outputs?.findIndex((e=>e.name===t&&e.node===o&&e.port===i));if(-1===l)return n;const c={...a[e].connections.outputs[l],waypoints:[...a[e].connections.outputs[l].waypoints||[]]};return c.waypoints.push(r),a[e]={...a[e],connections:{...a[e].connections,outputs:[...a[e].connections.outputs.slice(0,l),c,...a[e].connections.outputs.slice(l+1)]}},{...n,nodes:a}}))}),[n]),updateWaypointPosition:l(((e,t,o,i,r,s)=>{n((n=>{var a;const l={...null!==(a=n.nodes)&&void 0!==a?a:{}};if(!l[e])return n;const c=l[e].connections?.outputs?.findIndex((e=>e.name===t&&e.node===o&&e.port===i));if(-1===c)return n;const u={...l[e].connections.outputs[c],waypoints:[...l[e].connections.outputs[c].waypoints||[]]};return r>=0&&r<u.waypoints.length&&(u.waypoints[r]=s),l[e]={...l[e],connections:{...l[e].connections,outputs:[...l[e].connections.outputs.slice(0,c),u,...l[e].connections.outputs.slice(c+1)]}},{...n,nodes:l}}))}),[n]),removeWaypoint:l(((e,t,o,i,r)=>{n((n=>{var s;const a={...null!==(s=n.nodes)&&void 0!==s?s:{}};if(!a[e])return n;const l=a[e].connections?.outputs?.findIndex((e=>e.name===t&&e.node===o&&e.port===i));if(-1===l)return n;const c={...a[e].connections.outputs[l],waypoints:[...a[e].connections.outputs[l].waypoints||[]]};return c.waypoints.splice(r,1),a[e]={...a[e],connections:{...a[e].connections,outputs:[...a[e].connections.outputs.slice(0,l),c,...a[e].connections.outputs.slice(l+1)]}},{...n,nodes:a}}))}),[n]),connectNodes:l((({source:e,target:t})=>{let i=!1;return n((n=>{if(!n?.nodes||!Object.keys(n.nodes).length)return null;const r=e.nodeId,s=t.nodeId,a=e.portName,l=t.portName;if(r===s)return n;const c=JSON.parse(JSON.stringify(n.nodes[r])),u=JSON.parse(JSON.stringify(n.nodes[s])),d=o[c.type].outputs(c.values,c.connections?.inputs).find((e=>e.name===a)),p=o[u.type].inputs(u.values).find((e=>e.name===l));if(!d||!p||d.type!==p.type)return n;c.connections||(c.connections={}),c.connections?.outputs||(c.connections.outputs=[]),c.connections?.inputs||(c.connections.inputs=[]),u.connections||(u.connections={}),u.connections?.outputs||(u.connections.outputs=[]),u.connections?.inputs||(u.connections.inputs=[]),c.connections.outputs.find((e=>e.node===u.id&&e.name===p.name))||c.connections.outputs.push({name:d.name,node:u.id,port:p.name,type:d.type,waypoints:[]}),u.connections.inputs.find((e=>e.node===c.id&&e.name===d.name))||u.connections.inputs.push({name:p.name,node:c.id,port:d.name,type:d.type});const f={...n.nodes,[c.id]:c,[u.id]:u};return i=!0,{...n,nodes:f}})),i}),[n,o]),updateNodeValues:l(((e,t)=>{n((n=>({...n,nodes:{...n.nodes,[e]:{...n.nodes[e],values:t}}})))}),[n])}}({state:W,setStateAndNotify:ue,setSelectedNodes:K,nodeTypes:t}),{copyNodesToClipboard:Se,pasteNodesFromClipboard:Pe}=function({state:e,setStateAndNotify:n,setSelectedNodes:t,setSelectedWaypoints:o,nodeTypes:i,position:r,scale:s,pointerPosition:a,screenRef:c}){return{copyNodesToClipboard:l((n=>{if(!n?.length)return void console.warn("[useClipboard] No nodes selected to copy");const t={};for(const o of n)e.nodes[o]?t[o]=e.nodes[o]:console.warn(`[useClipboard] Node with id ${o} not found in state`);if(0===Object.keys(t).length)return void console.warn("[useClipboard] Could not find any nodes to copy");const o=JSON.stringify(t);navigator.clipboard.writeText(o).catch((e=>console.error("[useClipboard] Error copying data:",e)))}),[e?.nodes]),pasteNodesFromClipboard:l(((e=null)=>{if(!c?.current)return void console.error("[useClipboard] screenRef not available");const l=e||window.mousePosition||a;navigator.clipboard.readText().then((e=>{try{if(!e)return void console.warn("[useClipboard] Empty clipboard");const a=JSON.parse(e),u=Object.values(a).filter((e=>!e.root));if(0===u.length)return void console.warn("[useClipboard] No valid nodes to paste");let d=!0,p="";for(const e of u){if(!i[e.type]){d=!1,p=`Invalid node type: ${e.type}`;break}if(!e.position){d=!1,p=`Node without position: ${e.id}`;break}e.connections?void 0!==e.connections.inputs&&void 0!==e.connections.outputs||(void 0===e.connections.inputs&&(e.connections.inputs=[]),void 0===e.connections.outputs&&(e.connections.outputs=[])):e.connections={inputs:[],outputs:[]}}if(!d)return void console.error(`[useClipboard] Invalid data: ${p}`);const f=u.reduce(((e,n)=>{var t;return n.position.x<(null!==(t=e?.position?.x)&&void 0!==t?t:Number.POSITIVE_INFINITY)?n:e}),null);if(!f)return void console.error("[useClipboard] Could not find reference node for positioning");const m={x:f.position.x,y:f.position.y};if(!c.current)return void console.error("[useClipboard] screenRef.current not available");const y=c.current.getBoundingClientRect();if(!y)return void console.error("[useClipboard] Could not get element rectangle");const{x:v,y:h}=y,g={x:(l.x-v-r.x)/s,y:(l.y-h-r.y)/s},x={},b=u.map((e=>{const n=e.id,t=sn();x[n]=t;const o={x:e.position.x-m.x+g.x,y:e.position.y-m.y+g.y};return{...e,id:t,position:o,connections:{inputs:e.connections?.inputs?.filter((e=>u.find((n=>n.id===e.node)))),outputs:e.connections?.outputs?.filter((e=>u.find((n=>n.id===e.node))))}}}));for(const e of b){if(e.connections?.inputs)for(const n of e.connections.inputs)n.node=x[n.node];if(e.connections?.outputs)for(const n of e.connections.outputs)n.node=x[n.node],n.waypoints&&n.waypoints.length>0&&(n.waypoints=n.waypoints.map((e=>({x:e.x-m.x+g.x,y:e.y-m.y+g.y}))))}const w=[];for(const e of b)if(e.connections?.outputs)for(const n of e.connections.outputs)n.waypoints&&n.waypoints.length>0&&n.waypoints.forEach(((t,o)=>{w.push({srcNode:e.id,srcPort:n.name,dstNode:n.node,dstPort:n.port,waypointIndex:o})}));n((e=>{const n={...e.nodes,...b.reduce(((e,n)=>(e[n.id]=n,e)),{})};return{...e,nodes:n}}));const C=b.map((e=>e.id));t&&t(C),o&&o(w)}catch(e){console.error("[useClipboard] Error processing clipboard data:",e)}})).catch((e=>{console.error("[useClipboard] Error reading from clipboard:",e)}))}),[e,n,t,o,i,r,s,c])}}({state:W,setStateAndNotify:ue,setSelectedNodes:K,setSelectedWaypoints:J,nodeTypes:t,position:N,scale:V,pointerPosition:L,screenRef:de});!function({screenRef:e,removeNodes:n,selectedNodes:t,setSelectedNodes:o,selectAllNodes:r,copyNodesToClipboard:s,pasteNodesFromClipboard:a}){i((()=>{const i=e.current;if(!i)return;const l=()=>{},c=i=>{if(e.current===document.activeElement){switch(i.key.toLowerCase()){case"delete":case"backspace":n(t);break;case"escape":o([])}if(i.ctrlKey||i.metaKey)switch(i.key.toLowerCase()){case"a":i.preventDefault(),i.stopPropagation(),r();break;case"c":i.preventDefault(),i.stopPropagation(),s(t);break;case"v":i.preventDefault(),i.stopPropagation();const e=window.mousePosition||{x:i.clientX,y:i.clientY};a(e)}}};return i.addEventListener("focus",l),i.addEventListener("blur",l),i.addEventListener("keydown",c),()=>{i.removeEventListener("focus",l),i.removeEventListener("blur",l),i.removeEventListener("keydown",c)}}),[e.current,t,n,o,r,s,a])}({screenRef:de,removeNodes:ye,selectedNodes:Z,setSelectedNodes:K,selectAllNodes:te,copyNodesToClipboard:Se,pasteNodesFromClipboard:Pe});const Me=l((e=>{if(1===e.button)return void F("move");if(0!==e.button)return;e.stopPropagation();const n=e.ctrlKey?"select-remove":e.shiftKey?"select-add":"select";F(n);const t=e.pageX+window.scrollX,o=e.pageY+window.scrollY,i={x:t,y:o};Q(i),ee(i);const r=e=>{const n=e.pageX+window.scrollX,t=e.pageY+window.scrollY;ee({x:n,y:t})},s=e=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s);const a=e.pageX+window.scrollX,l=e.pageY+window.scrollY;if(Math.abs(a-t)>=2&&Math.abs(l-o)>=2){const e={x:a,y:l};ee(e);const t=[],o=W.nodes?Object.values(W.nodes):[],r={x:Math.min(i.x,e.x),y:Math.min(i.y,e.y)},s={x:Math.max(i.x,e.x),y:Math.max(i.y,e.y)};o.forEach((e=>{const n=document.getElementById(`card-${e.id}`);if(!n)return;const{x:o,y:i,width:a,height:l}=n.getBoundingClientRect();o>r.x&&o+a<s.x&&i>r.y&&i+l<s.y&&t.push(e.id)}));const c=[];W.nodes&&Object.values(W.nodes).forEach((e=>{e.connections?.outputs&&e.connections.outputs.forEach((n=>{n.waypoints&&n.waypoints.forEach(((t,o)=>{const i=t.x*V+N.x+window.scrollX,a=t.y*V+N.y+window.scrollY;i>r.x&&i<s.x&&a>r.y&&a<s.y&&c.push({srcNode:e.id,srcPort:n.name,dstNode:n.node,dstPort:n.port,waypointIndex:o})}))}))})),console.warn("selectedWaypoints",c),le({p1:r,p2:s},n,t,c),Q(e)}Q({x:0,y:0}),ee({x:0,y:0})};window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)}),[N,V,W,Z]);i((()=>{const e=e=>{const n={x:e.pageX-window.scrollX,y:e.pageY-window.scrollY};window.mousePosition=n,Y(n)};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]),i((()=>{if(!M){if(O&&!j){A(!0);const e=setTimeout((()=>{I(null),A(!1)}),500);return()=>clearTimeout(e)}return I(null),void X(!1)}A(!1),X(!1);const e=e=>{const n=e.pageX,t=e.pageY;I({x:n,y:t,srcX:M.startX,srcY:M.startY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[M,O,j]);const[Ne,Te]=n(!1),[He,Ve]=n(!0),[_e,Ee]=n(!0),Oe=l((e=>{const n=e.state.scale;_(n);const t={x:e.state.positionX,y:e.state.positionY};H(t)}),[H,_]);l((e=>{ue((n=>({...n,scale:e.state.scale,position:{x:e.state.positionX,y:e.state.positionY}})))}),[ue]);const ke=l((e=>{const n={x:e.state.positionX,y:e.state.positionY};H(n)}),[H]),Ie=l((e=>{const{state:{positionX:n,positionY:t,scale:o}}=e;H({x:n,y:t}),_(o),ce(((e,n,t)=>{ue((o=>({...o,position:{x:e,y:n},scale:t})))}),200)(n,t,o)}),[H,_,ue,ce]),Le=40,Ye=Le*(null!=V?V:1),Ae=(null!==(m=N?.x)&&void 0!==m?m:0)%Ye,je=(null!==(v=N?.y)&&void 0!==v?v:0)%Ye,{moveHandler:We}=function({state:e,setState:n,setStateAndNotify:t,gridSize:o,snapToGrid:r,selectedNodes:s,setSelectedNodes:a,selectedWaypoints:c,setSelectedWaypoints:u,isWaypointSelected:d}){return i((()=>{console.log("[useElementMovement] Initialized with state:",e)}),[e]),{moveHandler:l(((e,i,l)=>{const c={...i},u=[...s];u.includes(e.id)||(u.length=0,u.push(e.id)),a(u),(l?n:t)((n=>({...n,nodes:Object.values(n.nodes).reduce(((t,i)=>{const s={x:c.x-n.nodes[e.id].position.x,y:c.y-n.nodes[e.id].position.y};return r&&(c.x=Math.round(c.x/o)*o,c.y=Math.round(c.y/o)*o,s.x=c.x-n.nodes[e.id].position.x,s.y=c.y-n.nodes[e.id].position.y),i.id===e.id?t[i.id]={...i,position:c,connections:{...i.connections,outputs:i.connections?.outputs?.map((e=>({...e,waypoints:e.waypoints?.map(((n,t)=>d({srcNode:i.id,srcPort:e.name,dstNode:e.node,dstPort:e.port,waypointIndex:t})?{x:n.x+s.x,y:n.y+s.y}:n))})))}}:u.includes(i.id)?t[i.id]={...i,position:{x:i.position.x+s.x,y:i.position.y+s.y},connections:{...i.connections,outputs:i.connections?.outputs?.map((e=>({...e,waypoints:e.waypoints?.map(((n,t)=>d({srcNode:i.id,srcPort:e.name,dstNode:e.node,dstPort:e.port,waypointIndex:t})?{x:n.x+s.x,y:n.y+s.y}:n))})))}}:t[i.id]=i,t}),{})})))}),[s,c,a,n,t,r,o,d])}}({state:W,setState:R,setStateAndNotify:ue,selectedWaypoints:q,gridSize:Le,snapToGrid:_e,selectedNodes:Z,setSelectedNodes:K,selectedWaypoints:q,setSelectedWaypoints:J,isWaypointSelected:ae}),Be=l((e=>{const n=we(e);return X(Boolean(n)),console.log("Connection attempt:",n?"successful":"failed"),n}),[we]),De=s((()=>({step:5})),[]),Fe=s((()=>({disabled:Ne,excluded:[E.node,"react-draggable",x.port,x.portConnector,on.container,on.moveHandler]})),[Ne]),Ze=s((()=>({height:"100%",width:"100%",backgroundColor:S.colors?.background,backgroundSize:`${Ye}px ${Ye}px`,backgroundImage:`linear-gradient(to right, ${S.colors?.hover} 1px, transparent 1px), linear-gradient(to bottom, ${S.colors?.hover} 1px, transparent 1px)`,backgroundPosition:`${Ae}px ${je}px`})),[Ye,Ae,je,S]),Ke=s((()=>{const e=Object.values(t).reduce(((e,n)=>{var t;if(n.root||"comment"===n.type)return e;const o=null!==(t=n.category)&&void 0!==t?t:"...";return e[o]||(e[o]=[]),e[o].push(n),e}),{});return Object.entries(e).map((([e,n])=>({category:e,nodeTypes:n})))}),[t]),qe=e=>({label:Ge(c,"contextMenu.addComment.label",{},"Add comment"),description:Ge(c,"contextMenu.addComment.description",{},"Add a comment to the screen"),onClick:()=>{const n=e.target.getBoundingClientRect(),{x:t,y:o}=n,i={x:(e.clientX-N.x-t)/V,y:(e.clientY-N.y-o)/V};_e&&(i.x=Math.round(i.x/Le)*Le,i.y=Math.round(i.y/Le)*Le),me(C,i)}}),Je=l((e=>({onDragOver:e=>{e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move"},onDragLeave:e=>{e.preventDefault(),e.stopPropagation()},onContextMenu:n=>e(n,[...Ke.map((({category:e,nodeTypes:t})=>({label:e,children:t.filter((e=>!e.root&&e.type!==C.type)).sort(((e,n)=>e.label.localeCompare(n.label))).map((e=>({label:Ge(c,"contextMenu.add",{nodeType:e.label},"Add "+e.label),description:e.description,onClick:()=>{var t,o;const i=n.target.getBoundingClientRect(),{x:r,y:s}=i,a={x:(n.clientX-(null!==(t=N?.x)&&void 0!==t?t:0)-r)/V,y:(n.clientY-(null!==(o=N?.y)&&void 0!==o?o:0)-s)/V};_e&&(a.x=Math.round(a.x/Le)*Le,a.y=Math.round(a.y/Le)*Le),me(e,a)}})))}))),qe(n)]),onMouseDown:Me,onClick:e=>{e.target===fe.current.instance.wrapperComponent&&de.current.focus({preventScroll:!0})}})),[W,D,Ke,me,N,V]),Ue=l(((e,n)=>{Ce(e,n)}),[Ce]),Qe=l((()=>{Ee((e=>!e))}),[]);return W?u("div",{className:tn.container,style:P,ref:de,tabIndex:0,children:u(ze,{initialScale:null!==(h=W?.scale)&&void 0!==h?h:1,initialPositionX:null!==(b=W?.position?.x)&&void 0!==b?b:0,initialPositionY:null!==(w=W?.position?.y)&&void 0!==w?w:0,disabled:Ne,minScale:.1,maxScale:2,limitToBounds:!1,onPanning:ke,onZoom:Oe,pinch:De,panning:Fe,onTransformed:Ie,ref:fe,children:({zoomIn:n,zoomOut:o,resetTransform:i,setTransform:r,centerView:s,...a})=>{const l=pe?{x:U.x-pe.left,y:U.y-pe.top}:{x:0,y:0},m=pe?{x:G.x-pe.left,y:G.y-pe.top}:{x:0,y:0};return d(p,{children:[u(Yn,{localStartPoint:l,localEndPoint:m}),u(On,{zoomIn:n,zoomOut:o,centerView:s,resetView:()=>{r(N.x,N.y,1),_(1)},canMove:He,setCanMove:Ve,position:N,scale:V,setStateAndNotify:ue}),u(kn,{snapToGrid:_e,handleSnapToGrid:Qe,viewMode:D}),u(In,{scale:V,position:N}),u(nn,{containerRef:de,i18n:c,children:({handleContextMenu:n})=>d(Xe,{contentClass:"main",wrapperStyle:Ze,wrapperProps:Je(n),children:[W?.nodes&&Object.values(W.nodes).map(((o,i)=>{const r=t[o.type];return"comment"===o.type?u(rn,{nodeId:o.id,text:o.value||"",title:o.title||"",isSelected:Z.includes(o.id),onChangeText:e=>{ue((n=>({...n,nodes:{...n.nodes,[o.id]:{...n.nodes[o.id],value:e}}})))},onChangeTitle:e=>{ue((n=>({...n,nodes:{...n.nodes,[o.id]:{...n.nodes[o.id],title:e}}})))},id:o.id,position:o.position,size:o.size,onResize:e=>{_e&&(e.w=Math.round(e.w/Le)*Le,e.h=Math.round(e.h/Le)*Le),ue((n=>({...n,nodes:{...n.nodes,[o.id]:{...n.nodes[o.id],size:e}}})))},onMove:e=>We(o,e,!1),onMoveEnd:e=>We(o,e,!0),onContextMenu:e=>n(e,[{label:Ge(c,"contextMenu.cloneThisComment",{},"Clone this comment"),onClick:()=>{ve(o.id)}},{label:Ge(c,"contextMenu.removeThisComment",{},"Remove this comment"),style:{color:"red"},onClick:()=>{ye([o.id])}},Z?.length>0?{label:Ge(c,"contextMenu.removeSelectedNodes",{},"Remove selected nodes"),style:{color:"red"},onClick:()=>{ye(Z)}}:null])},o.id):d(p,{children:[u(k,{id:`node_${o.id}`,name:o.name,portTypes:e,nodeType:t?.[o.type],debugMode:f,value:o,isSelected:Z.includes(o.id),onValueChange:e=>{Ue(o.id,{...e.values})},onChangePosition:e=>We(o,e,!1),onDragEnd:e=>We(o,e,!0),containerRef:de,canMove:He,onConnect:Be,onContextMenu:e=>n(e,[r.root?null:{label:Ge(c,"contextMenu.cloneThisNode",{},"Clone this node"),onClick:()=>{ve(o.id)}},r.root?null:{label:Ge(c,"contextMenu.removeThisNode",{},"Remove this node"),style:{color:"red"},onClick:()=>{ye([o.id])}},Z?.length>0?{label:Ge(c,"contextMenu.removeSelectedNodes",{},"Remove selected nodes"),style:{color:"red"},onClick:()=>{ye(Z)}}:null]),onResize:e=>{R((n=>{var t;return{...n,nodes:{...n.nodes,[o.id]:{...n.nodes[o.id],size:e,connections:{...n.nodes[o.id].connections,outputs:[...null!==(t=n.nodes[o.id].connections?.outputs)&&void 0!==t?t:[]]}}}}}))}},`node_${o.id}`),o.connections?.outputs?.map(((t,i)=>{const r=o.id,s=t.name,a=t.node,l=t.port,d=t.type,p=t.waypoints||[],f=document.getElementById(`card-${r}`),m=document.getElementById(`card-${a}`),y=document.getElementById(`card-${r}-output-${s}`),v=document.getElementById(`card-${a}-input-${l}`);if(!(y&&v&&pe&&f&&m))return null;const h=y.getBoundingClientRect(),g=v.getBoundingClientRect(),x=f.getBoundingClientRect(),b=m.getBoundingClientRect(),w={x:(h.x-N.x-pe.left+h.width/2)/V,y:(h.y-N.y-pe.top+h.height/2)/V},C={x:(g.x-N.x-pe.left+g.width/2)/V,y:(g.y-N.y-pe.top+g.height/2)/V},S={x:(x.x-N.x-pe.left)/V,y:(x.y-N.y-pe.top)/V,w:x.width,h:x.height},P={x:(b.x-N.x-pe.left)/V,y:(b.y-N.y-pe.top)/V,w:b.width,h:b.height};return u($e,{type:e[d],src:w,dst:C,scale:V,n1Box:S,n2Box:P,index:i,waypoints:p,onUpdateWaypoint:(e,n)=>xe(r,s,a,l,e,n),isWaypointSelected:e=>ae({srcNode:r,srcPort:s,dstNode:a,dstPort:l,waypointIndex:e}),onWaypointMouseDown:(e,n)=>{e.ctrlKey?se({srcNode:r,srcPort:s,dstNode:a,dstPort:l,waypointIndex:n}):e.shiftKey?re({srcNode:r,srcPort:s,dstNode:a,dstPort:l,waypointIndex:n}):ae({srcNode:r,srcPort:s,dstNode:a,dstPort:l,waypointIndex:n})||J([{srcNode:r,srcPort:s,dstNode:a,dstPort:l,waypointIndex:n}])},onWaypointContextMenu:(e,t)=>n(e,[He?{label:Ge(c,"contextMenu.removeWaypoint",{},"Remove waypoint"),style:{color:"red"},onClick:()=>{be(r,s,a,l,t)}}:null].filter(Boolean)),onContextMenu:e=>n(e,[He?{label:Ge(c,"contextMenu.addWaypoint",{},"Add waypoint"),onClick:()=>{const n=(e.clientX-pe.left-N.x)/V,t=(e.clientY-pe.top-N.y)/V;ge(r,s,a,l,{x:n,y:t})}}:null,He?{label:Ge(c,"contextMenu.removeThisConnection",{},"Remove this connection"),style:{color:"red"},onClick:()=>{he(r,s,a,l)}}:null].filter(Boolean))},`connector-${r}-${s}-${a}-${l}`)}))]})})),(M||z)&&O?u(Re,{tmp:!0,invalid:z,src:{x:((M&&M.startX||z&&O.srcX)-pe.left-N.x+10-2)/V,y:((M&&M.startY||z&&O.srcY)-pe.top-N.y+10-2)/V},dst:{x:(O.x-window.scrollX-pe.left-N.x)/V,y:(O.y-window.scrollY-pe.top-N.y)/V},scale:V}):null]})})]})}})}):null}function jn({theme:e,themes:n,state:t,...o}){return u(h,{initialState:t,children:u(m,{children:u(An,{...o})})})}export{jn as NodeContainer,N as ThemeProvider,T as useTheme};
